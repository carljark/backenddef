(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{59:function(t,e,i){"use strict";i.r(e);var s=i(57),a=i(58),r=i(87),h=i(61),n=i(85),o=i(90),l=i(86),c=i(91),p=i(94),m=i(92),d=i(93);var g={date:"%d.%m.%Y",dateTime:"%a %b %e %X %Y",days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],periods:["AM","PM"],shortDays:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],shortMonths:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],time:"%H:%M:%S"},u=i(6);i.d(e,"GraphLineComponent",function(){return x}),s.timeFormatDefaultLocale(g);class x{constructor(t){this.lineas=t,this.d={price:0,timestamp:new Date},this.bisectDate=s.bisector(t=>t.timestamp).right,this.bisectValue=s.bisector(t=>t.price).right,this.svgWidth=800,this.svgHeight=300,this.margin={top:30,right:40,bottom:50,left:60},this.width=this.svgWidth-this.margin.left-this.margin.right,this.height=this.svgHeight-this.margin.top-this.margin.bottom,this.originalCircle={cx:-150,cy:-15,r:20},this.chartProps={},this.titleGraph="",this.ngOnInit()}static removeSvg$(t){return Object(r.a)(s.select(`#${t}`).remove()).pipe(Object(o.a)(!0))}onclickremove(){document.getElementById(`${this.titleGraph}data`).className="fila",x.removeSvg$(this.titleGraph)}getLine1(){return new h.a(t=>{this.linea1=this.lineas[0],t.next(this.lineas[0])})}getTitles(){return new h.a(t=>{let e="";this.lineas.forEach(t=>{t.name&&(e=""===e?t.name:e+" / "+t.name)}),this.titleGraph=e,t.next(e)})}ngOnInit(){this.getTitles().pipe(Object(l.a)(()=>this.getLine1()),Object(c.a)(()=>this.defineChart$()),Object(c.a)(()=>Object(n.a)(this.lineas)),Object(l.a)(t=>this.drawLine$(t)),Object(p.a)(1e3),Object(m.a)(()=>this.addToolTips$()),Object(m.a)(()=>this.addEventsArea()),Object(d.a)(()=>Object(r.a)("error"))).subscribe(()=>{this.addTitleGraph()})}defineChart$(){return new h.a(t=>{this.defineChart(),t.next(!0)})}defineChart(){console.log("titleGraph: ",this.titleGraph),this.lineGraphElement=document.getElementById("linechart"),this.svgViewport=s.select(this.lineGraphElement).append("svg").attr("id",this.titleGraph).style("background","white").attr("viewBox",`0 0 ${this.svgWidth} ${this.svgHeight}`),this.chartProps.xScale=s.scaleTime().domain(s.extent(this.linea1.timePriceArray,t=>new Date(t.timestamp).getTime())).range([0,this.width]).clamp(!0),this.svgViewport.on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),this.chartProps.yScale=s.scaleLinear().domain([0,s.max(this.lineas,t=>1.1*Math.max(...t.timePriceArray.map(t=>t.price)))]).range([this.height,0]).clamp(!0),this.xAxis=s.axisBottom(this.chartProps.xScale),this.yAxis=s.axisLeft(this.chartProps.yScale),this.zoom=s.zoom().scaleExtent([1,1/0]).translateExtent([[0,0],[this.width,this.height]]).extent([[0,0],[this.width,this.height]]).on("zoom",this.zoomFunction.bind(this)),this.innerSpace=this.svgViewport.append("g").attr("class","inner_space").attr("transform","translate("+this.margin.left+","+this.margin.top+")").call(this.zoom.bind(this));const t=s.timeFormat("%d/%m %H:%M");this.gX=this.innerSpace.append("g").attr("class","axis axis--x").attr("transform","translate(0,"+this.height+")").call(this.xAxis.ticks(6).tickFormat(t)),this.gY=this.innerSpace.append("g").attr("class","axis axis--y").call(this.yAxis),this.originalLine=s.line().x(t=>{if(t.timestamp instanceof Date)return this.chartProps.xScale(t.timestamp.getTime())}).y(t=>this.chartProps.yScale(t.price)),this.scaledLine=s.line().x(t=>{if(t.timestamp instanceof Date)return this.newxScale(t.timestamp.getTime())}).y(t=>this.newyScale(t.price));this.svgViewport.append("rect").attr("x",0).attr("y",0).attr("width",30).attr("height",30).attr("fill","red").on("click",this.onclickremove.bind(this)),this.svgViewport.append("line").attr("class","aspas").attr("x1",30).attr("x2",0).attr("y1",0).attr("y2",30).attr("pointer-events","none"),this.svgViewport.append("line").attr("class","aspas").attr("x1",0).attr("x2",30).attr("y1",0).attr("y2",30).attr("pointer-events","none")}addEventsArea(){return new h.a(t=>{this.view=this.innerSpace.append("rect").attr("class","zoom").attr("width",this.width).attr("height",this.height).on("mouseover",this.mouseover.bind(this)).on("mouseout",()=>{this.focus.style("display","none")}).on("mousemove",this.mousemove.bind(this)).on("touchstart",this.touchStart.bind(this)).on("touchmove",this.touchMove.bind(this)).on("touchend",()=>{this.focus.style("display",null)}),t.next(!0)})}drawLine$(t){return new h.a(e=>{this.drawLine(t),e.next(t)})}drawLine(t){t.timePriceArray.forEach(t=>{t.timestamp=a(t.timestamp).toDate()}),this.lineSvg=this.innerSpace.append("path").datum(t.timePriceArray).attr("class","linegraph").style("stroke","black").attr("d",this.originalLine.bind(this)(t.timePriceArray))}zoomFunction(){this.newxScale=s.event.transform.rescaleX(this.chartProps.xScale),this.newyScale=s.event.transform.rescaleY(this.chartProps.yScale),this.gX.call(this.xAxis.scale(this.newxScale)),this.gY.call(this.yAxis.scale(this.newyScale)),this.lineSvg.call(this.xAxis.scale(this.newxScale)),this.lineSvg.call(this.yAxis.scale(this.newyScale)),this.d3eventtransform=s.event.transform,this.changeLine(),this.moveToolTip()}changeLine(){this.lineSvg.attr("d",this.scaledLine.bind(this))}addTitleGraph(){this.titleSvg=this.innerSpace.append("text").attr("x",this.margin.left).attr("y",260).attr("class","graphic_title_text").attr("text-anchor","start").text(this.titleGraph)}addToolTips$(){return new h.a(t=>{this.addToolTips(),t.next(!0)})}addToolTips(){this.focus=this.innerSpace.append("g").attr("class","this.focus").style("display","none"),this.focus.append("line").attr("class","x-hover-line hover-line").attr("y1",0).attr("y2",this.height).attr("pointer-events","none"),this.focus.append("line").attr("class","y-hover-line hover-line").attr("x1",0).attr("x2",this.width).attr("pointer-events","none"),this.focus.append("circle").attr("r",2).attr("pointer-events","none"),this.textToolTip=this.focus.append("text").attr("id","textToolTip").attr("class","text_tooltip").attr("text-anchor","end").attr("y",-20).attr("dy",".31em")}getDataPoint(){if(this.d){return`${a(this.d.timestamp).format(u.a.tooltipTimeFormat)}: ${(Math.round(100*this.d.price)/100).toLocaleString()}€`}return"no data"}touchMove(t,e,i){s.event.preventDefault(),s.event.stopPropagation();s.touches(i[e]);this.focus.style("display",null),this.mousemove(t,e,i)}touchStart(t,e,i){s.event.preventDefault(),s.event.stopPropagation();s.touches(i[e]);this.focus.style("display",null),this.mousemove(t,e,i)}mouseover(t,e,i){s.event.preventDefault(),s.event.stopPropagation(),this.focus.style("display",null),this.mousemove(t,e,i)}mousemove(t,e,i){let a;a=this.newxScale?this.newxScale.invert(s.mouse(i[e])[0]):this.chartProps.xScale.invert(s.mouse(i[e])[0]);const r=this.bisectDate(this.linea1.timePriceArray,a,1),h=this.linea1.timePriceArray[r-1],n=this.linea1.timePriceArray.length;let o;o=r>=this.linea1.timePriceArray.length?this.linea1.timePriceArray[n-1]:this.linea1.timePriceArray[r],this.d=a.getTime()-h.timestamp.getTime()>o.timestamp.getTime()-a.getTime()?o:h,this.moveToolTip()}moveToolTip(){let t;this.newxScale?(this.focus.attr("transform",`translate(${this.newxScale(new Date(this.d.timestamp))},${this.newyScale(this.d.price)})`),t=this.newxScale(new Date(this.d.timestamp))):(this.focus.attr("transform",`translate(${this.chartProps.xScale(new Date(this.d.timestamp))},${this.chartProps.yScale(this.d.price)})`),t=this.chartProps.xScale(new Date(this.d.timestamp))),this.textToolTip.text(this.getDataPoint.bind(this));const e=this.textToolTip.node();let i;(i=e.getBBox()).width+10>t?(this.textToolTip.attr("text-anchor","start"),i=e.getBBox()):this.textToolTip.attr("text-anchor","end"),this.focus.selectAll("rect").remove();this.focus.append("rect").attr("x",i.x).attr("y",i.y).attr("width",i.width).attr("height",i.height).style("fill","white").style("fill-opacity",".9").style("stroke","#666").style("stroke-width","0.5px");this.focus.node().insertBefore(e,null);let s=0;s=this.newyScale?this.newyScale(this.d.price):this.chartProps.yScale(this.d.price),this.focus.select(".x-hover-line").attr("y2",this.height-s),this.focus.select(".y-hover-line").attr("x2",-t)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZDMtdGltZWZvcm1hdGRlZmF1bHRsb2NhbGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2QzaGlzdG9yeWdyYXBoLnRzIl0sIm5hbWVzIjpbImQzX3RpbWVmb3JtYXRkZWZhdWx0bG9jYWxlIiwiZGF0ZSIsImRhdGVUaW1lIiwiZGF5cyIsIm1vbnRocyIsInBlcmlvZHMiLCJzaG9ydERheXMiLCJzaG9ydE1vbnRocyIsInRpbWUiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZCIsIl9fd2VicGFja19leHBvcnRzX18iLCJkM2hpc3RvcnlncmFwaF9HcmFwaExpbmVDb21wb25lbnQiLCJleHRlcm5hbF9kM18iLCJbb2JqZWN0IE9iamVjdF0iLCJsaW5lYXMiLCJ0aGlzIiwicHJpY2UiLCJ0aW1lc3RhbXAiLCJEYXRlIiwiYmlzZWN0RGF0ZSIsInJpZ2h0IiwiYmlzZWN0VmFsdWUiLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsIm1hcmdpbiIsInRvcCIsImJvdHRvbSIsImxlZnQiLCJ3aWR0aCIsImhlaWdodCIsIm9yaWdpbmFsQ2lyY2xlIiwiY3giLCJjeSIsInIiLCJjaGFydFByb3BzIiwidGl0bGVHcmFwaCIsIm5nT25Jbml0IiwiY29pbk5hbWUiLCJPYmplY3QiLCJvZiIsInJlbW92ZSIsInBpcGUiLCJtYXBUbyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjbGFzc05hbWUiLCJyZW1vdmVTdmckIiwiT2JzZXJ2YWJsZSIsIm9iIiwibGluZWExIiwibmV4dCIsInRpdGxlcyIsImZvckVhY2giLCJsaW5kYXRhIiwibmFtZSIsImdldFRpdGxlcyIsIm1lcmdlTWFwIiwiZ2V0TGluZTEiLCJzd2l0Y2hNYXAiLCJkZWZpbmVDaGFydCQiLCJmcm9tIiwibGluIiwiZHJhd0xpbmUkIiwiZGVsYXkiLCJjb25jYXRNYXAiLCJhZGRUb29sVGlwcyQiLCJhZGRFdmVudHNBcmVhIiwiY2F0Y2hFcnJvciIsInN1YnNjcmliZSIsImFkZFRpdGxlR3JhcGgiLCJkZWZpbmVDaGFydCIsImNvbnNvbGUiLCJsb2ciLCJsaW5lR3JhcGhFbGVtZW50Iiwic3ZnVmlld3BvcnQiLCJhcHBlbmQiLCJhdHRyIiwic3R5bGUiLCJ4U2NhbGUiLCJkb21haW4iLCJ0aW1lUHJpY2VBcnJheSIsImdldFRpbWUiLCJyYW5nZSIsImNsYW1wIiwib24iLCJ5U2NhbGUiLCJNYXRoIiwibWF4IiwibWFwIiwidmFsdWUiLCJ4QXhpcyIsInlBeGlzIiwiem9vbSIsInNjYWxlRXh0ZW50IiwiSW5maW5pdHkiLCJ0cmFuc2xhdGVFeHRlbnQiLCJleHRlbnQiLCJ6b29tRnVuY3Rpb24iLCJiaW5kIiwiaW5uZXJTcGFjZSIsImNhbGwiLCJmb3JtYXRFdmVyZCIsImdYIiwidGlja3MiLCJ0aWNrRm9ybWF0IiwiZ1kiLCJvcmlnaW5hbExpbmUiLCJ4IiwieSIsInNjYWxlZExpbmUiLCJuZXd4U2NhbGUiLCJuZXd5U2NhbGUiLCJvbmNsaWNrcmVtb3ZlIiwidmlldyIsIm1vdXNlb3ZlciIsImZvY3VzIiwibW91c2Vtb3ZlIiwidG91Y2hTdGFydCIsInRvdWNoTW92ZSIsImxpbmUiLCJkcmF3TGluZSIsInBvaW50IiwiZXh0ZXJuYWxfbW9tZW50XyIsInRvRGF0ZSIsImxpbmVTdmciLCJkYXR1bSIsInRyYW5zZm9ybSIsInJlc2NhbGVYIiwicmVzY2FsZVkiLCJzY2FsZSIsImQzZXZlbnR0cmFuc2Zvcm0iLCJjaGFuZ2VMaW5lIiwibW92ZVRvb2xUaXAiLCJ0aXRsZVN2ZyIsInRleHQiLCJhZGRUb29sVGlwcyIsInRleHRUb29sVGlwIiwiZm9ybWF0IiwiZW52aXJvbm1lbnQiLCJ0b29sdGlwVGltZUZvcm1hdCIsInJvdW5kIiwidG9Mb2NhbGVTdHJpbmciLCJqIiwibm9kZXMiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BQcm9wYWdhdGlvbiIsIngwIiwiaW52ZXJ0IiwiaSIsImQwIiwiYUxlbmd0aCIsImxlbmd0aCIsImQxIiwiZGlzdGFuY2lheCIsImdldERhdGFQb2ludCIsInR4dE5vZGUiLCJub2RlIiwiYmJveCIsImdldEJCb3giLCJzZWxlY3RBbGwiLCJpbnNlcnRCZWZvcmUiLCJuZXd5MiIsInNlbGVjdCJdLCJtYXBwaW5ncyI6IjRMQThDZSxJQUFBQSxFQTVDdUMsQ0FDbERDLEtBQU0sV0FDTkMsU0FBVSxpQkFDVkMsS0FBTSxDQUNKLFVBQ0EsUUFDQSxTQUNBLFlBQ0EsU0FDQSxVQUNBLFVBRUZDLE9BQVEsQ0FDSixRQUNBLFVBQ0EsUUFDQSxRQUNBLE9BQ0EsUUFDQSxRQUNBLFNBQ0EsYUFDQSxVQUNBLFlBQ0EsYUFFSkMsUUFBUyxDQUFDLEtBQU0sTUFDaEJDLFVBQVcsQ0FBQyxLQUFNLEtBQU0sS0FBTSxLQUFNLEtBQU0sS0FBTSxNQUNoREMsWUFBYSxDQUNULE1BQ0EsTUFDQSxNQUNBLE1BQ0EsTUFDQSxNQUNBLE1BQ0EsTUFDQSxNQUNBLE1BQ0EsTUFDQSxPQUVKQyxLQUFNLG1CQzVDVkMsRUFBQUMsRUFBQUMsRUFBQSx1Q0FBQUMsSUFVQUMsRUFBQSx3QkFBMkJiLEdBT3BCLE1BQU1ZLEVBK0NURSxZQUNXQyxHQUFBQyxLQUFBRCxTQXpDSkMsS0FBQU4sRUFBZ0IsQ0FBQ08sTUFBTyxFQUFHQyxVQUFXLElBQUlDLE1BVTFDSCxLQUFBSSxXQUFhUCxFQUFBLFNBQWFILEdBQWtCQSxFQUFFUSxXQUFXRyxNQUN6REwsS0FBQU0sWUFBY1QsRUFBQSxTQUFhSCxHQUFrQkEsRUFBRU8sT0FBT0ksTUFDdERMLEtBQUFPLFNBQVcsSUFDWFAsS0FBQVEsVUFBWSxJQUNaUixLQUFBUyxPQUFTLENBQUVDLElBQUssR0FBSUwsTUFBTyxHQUFJTSxPQUFRLEdBQUlDLEtBQU0sSUFDakRaLEtBQUFhLE1BQVFiLEtBQUtPLFNBQVdQLEtBQUtTLE9BQU9HLEtBQU9aLEtBQUtTLE9BQU9KLE1BQ3ZETCxLQUFBYyxPQUFTZCxLQUFLUSxVQUFZUixLQUFLUyxPQUFPQyxJQUFNVixLQUFLUyxPQUFPRSxPQUd4RFgsS0FBQWUsZUFBaUIsQ0FDeEJDLElBQUssSUFDTEMsSUFBSyxHQUNMQyxF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QUssTUFBUTZFIiwiZmlsZSI6ImQzaGlzdG9yeWdyYXBoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGltZUxvY2FsZURlZmluaXRpb24gfSBmcm9tICdkMyc7XG5cbmNvbnN0IHRpbWVmb3JtYXRkZWZhdWx0bG9jYWxlOiBUaW1lTG9jYWxlRGVmaW5pdGlvbiA9IHtcbiAgICBkYXRlOiAnJWQuJW0uJVknLFxuICAgIGRhdGVUaW1lOiAnJWEgJWIgJWUgJVggJVknLFxuICAgIGRheXM6IFtcbiAgICAgICdEb21pbmdvJyxcbiAgICAgICdMdW5lcycsXG4gICAgICAnTWFydGVzJyxcbiAgICAgICdNacOpcmNvbGVzJyxcbiAgICAgICdKdWV2ZXMnLFxuICAgICAgJ1ZpZXJuZXMnLFxuICAgICAgJ1PDoWJhZG8nLFxuICAgIF0sXG4gICAgbW9udGhzOiBbXG4gICAgICAgICdFbmVybycsXG4gICAgICAgICdGZWJyZXJvJyxcbiAgICAgICAgJ01hcnpvJyxcbiAgICAgICAgJ0FicmlsJyxcbiAgICAgICAgJ01heW8nLFxuICAgICAgICAnSnVuaW8nLFxuICAgICAgICAnSnVsaW8nLFxuICAgICAgICAnQWdvc3RvJyxcbiAgICAgICAgJ1NlcHRpZW1icmUnLFxuICAgICAgICAnT2N0dWJyZScsXG4gICAgICAgICdOb3ZpZW1icmUnLFxuICAgICAgICAnRGljaWVtYnJlJyxcbiAgICBdLFxuICAgIHBlcmlvZHM6IFsnQU0nLCAnUE0nXSxcbiAgICBzaG9ydERheXM6IFsnRG8nLCAnTHUnLCAnTWEnLCAnTWknLCAnSnUnLCAnVmknLCAnU2EnXSxcbiAgICBzaG9ydE1vbnRoczogW1xuICAgICAgICAnRW5lJyxcbiAgICAgICAgJ0ZlYicsXG4gICAgICAgICdNYXInLFxuICAgICAgICAnQWJyJyxcbiAgICAgICAgJ01heScsXG4gICAgICAgICdKdW4nLFxuICAgICAgICAnSnVsJyxcbiAgICAgICAgJ0FnbycsXG4gICAgICAgICdTZXAnLFxuICAgICAgICAnT2N0JyxcbiAgICAgICAgJ05vdicsXG4gICAgICAgICdEaWMnLFxuICAgIF0sXG4gICAgdGltZTogJyVIOiVNOiVTJyxcbn07XG5leHBvcnQgZGVmYXVsdCB0aW1lZm9ybWF0ZGVmYXVsdGxvY2FsZTtcbiIsImltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcbmltcG9ydCAqIGFzIG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgZnJvbSwgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGNhdGNoRXJyb3IsIGNvbmNhdE1hcCwgZGVsYXksIG1hcFRvLCBtZXJnZU1hcCwgc3dpdGNoTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IElDb2luSGlzdG9yeSBmcm9tICcuL2NvaW4taGlzdG9yeS5pbnRlcmZhY2UnO1xuaW1wb3J0IHRpbWVGb3JtYXREZWZhdWx0TG9jYWxlIGZyb20gJy4vZDMtdGltZWZvcm1hdGRlZmF1bHRsb2NhbGUnO1xuaW1wb3J0IElUaW1lUHJpY2UgZnJvbSAnLi90aW1lcHJpY2UuaW50ZXJmYWNlJztcblxuaW1wb3J0IGNvbmZpZyBmcm9tICcuL2Vudmlyb25tZW50JztcblxuZDMudGltZUZvcm1hdERlZmF1bHRMb2NhbGUodGltZUZvcm1hdERlZmF1bHRMb2NhbGUpO1xuXG5pbnRlcmZhY2UgSVNjYWxlcyB7XG4gIHhTY2FsZTogZDMuU2NhbGVUaW1lPG51bWJlciwgbnVtYmVyPjtcbiAgeVNjYWxlOiBkMy5TY2FsZUxpbmVhcjxudW1iZXIsIG51bWJlcj47XG59XG5cbmV4cG9ydCBjbGFzcyBHcmFwaExpbmVDb21wb25lbnQge1xuICAgIHB1YmxpYyBzdGF0aWMgcmVtb3ZlU3ZnJChjb2luTmFtZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgICAgIHJldHVybiBvZihkMy5zZWxlY3QoYCMke2NvaW5OYW1lfWApLnJlbW92ZSgpKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICAgIG1hcFRvKHRydWUpLFxuICAgICAgICApO1xuICAgIH1cbiAgICBwdWJsaWMgZDogSVRpbWVQcmljZSA9IHtwcmljZTogMCwgdGltZXN0YW1wOiBuZXcgRGF0ZSgpfTtcbiAgICBwdWJsaWMgcGFuWDogYW55O1xuICAgIHB1YmxpYyBwYW5ZOiBhbnk7XG4gICAgcHVibGljIHNjYWxlTXVsdGlwbGllcjogYW55O1xuICAgIC8vIHB1YmxpYyBkM2V2ZW50dHJhbnNmb3JtOiBhbnkgPSB7IGs6IDEsIHg6IDAsIHk6IDAgfTtcbiAgICBwdWJsaWMgZDNldmVudHRyYW5zZm9ybTogYW55O1xuICAgIC8vIHB1YmxpYyBuZXd5U2NhbGU6IGQzLkF4aXNTY2FsZTxudW1iZXIgfCB7IHZhbHVlT2YoKTogbnVtYmVyOyB9PjtcbiAgICAvLyBwdWJsaWMgbmV3eFNjYWxlOiBkMy5BeGlzU2NhbGU8bnVtYmVyIHwgeyB2YWx1ZU9mKCk6IG51bWJlcjsgfT47XG4gICAgcHVibGljIG5ld3lTY2FsZTogYW55OyAvLyBhc2lnbmFyIGVuIGVsIGNvbnRydWN0b3IgbyBlcXVpdmFsZW50ZVxuICAgIHB1YmxpYyBuZXd4U2NhbGU6IGFueTtcbiAgICBwdWJsaWMgYmlzZWN0RGF0ZSA9IGQzLmJpc2VjdG9yKChkOiBJVGltZVByaWNlKSA9PiBkLnRpbWVzdGFtcCkucmlnaHQ7XG4gICAgcHVibGljIGJpc2VjdFZhbHVlID0gZDMuYmlzZWN0b3IoKGQ6IElUaW1lUHJpY2UpID0+IGQucHJpY2UpLnJpZ2h0O1xuICAgIHB1YmxpYyBzdmdXaWR0aCA9IDgwMDtcbiAgICBwdWJsaWMgc3ZnSGVpZ2h0ID0gMzAwO1xuICAgIHB1YmxpYyBtYXJnaW4gPSB7IHRvcDogMzAsIHJpZ2h0OiA0MCwgYm90dG9tOiA1MCwgbGVmdDogNjAgfTtcbiAgICBwdWJsaWMgd2lkdGggPSB0aGlzLnN2Z1dpZHRoIC0gdGhpcy5tYXJnaW4ubGVmdCAtIHRoaXMubWFyZ2luLnJpZ2h0O1xuICAgIHB1YmxpYyBoZWlnaHQgPSB0aGlzLnN2Z0hlaWdodCAtIHRoaXMubWFyZ2luLnRvcCAtIHRoaXMubWFyZ2luLmJvdHRvbTtcbiAgICBwdWJsaWMgb3JpZ2luYWxMaW5lOiBkMy5MaW5lPElUaW1lUHJpY2U+O1xuICAgIHB1YmxpYyBzY2FsZWRMaW5lOiBkMy5MaW5lPElUaW1lUHJpY2U+O1xuICAgIHB1YmxpYyBvcmlnaW5hbENpcmNsZSA9IHtcbiAgICBjeDogLTE1MCxcbiAgICBjeTogLTE1LFxuICAgIHI6IDIwLFxuICAgIH07XG4gICAgcHVibGljIGNoYXJ0UHJvcHMgPSB7fSBhcyBJU2NhbGVzO1xuICAgIHB1YmxpYyBnWDogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCB7fSwgbnVsbCwgdW5kZWZpbmVkPjtcbiAgICBwdWJsaWMgZ1k6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIGxpbmVTdmc6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIHZpZXc6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIGlubmVyU3BhY2U6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIHN2Z1ZpZXdwb3J0OiBkMy5TZWxlY3Rpb248U1ZHR0VsZW1lbnQsIHt9LCBudWxsLCB1bmRlZmluZWQ+O1xuICAgIHB1YmxpYyB0aXRsZVN2ZzogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCB7fSwgbnVsbCwgdW5kZWZpbmVkPjtcbiAgICBwdWJsaWMgZm9jdXM6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIHRleHRUb29sVGlwOiBkMy5TZWxlY3Rpb248U1ZHVGV4dEVsZW1lbnQsIHt9LCBudWxsLCB1bmRlZmluZWQ+O1xuICAgIHB1YmxpYyB6b29tOiBkMy5ab29tQmVoYXZpb3I8RWxlbWVudCwge30+O1xuICAgIHB1YmxpYyB4QXhpczogZDMuQXhpczxudW1iZXIgfCB7IHZhbHVlT2YoKTogbnVtYmVyIH0+O1xuICAgIHB1YmxpYyB5QXhpczogZDMuQXhpczxudW1iZXIgfCB7IHZhbHVlT2YoKTogbnVtYmVyIH0+O1xuICAgIHB1YmxpYyBsaW5lR3JhcGhFbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgICBwdWJsaWMgbGluZWExOiBJQ29pbkhpc3Rvcnk7XG4gICAgcHVibGljIHRpdGxlR3JhcGggPSAnJztcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGxpbmVhczogSUNvaW5IaXN0b3J5W10sXG4gICAgKSB7XG4gICAgICAgIHRoaXMubmdPbkluaXQoKTtcbiAgICB9XG4gICAgcHVibGljIG9uY2xpY2tyZW1vdmUoKSB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3RoaXMudGl0bGVHcmFwaH1kYXRhYCkuY2xhc3NOYW1lID0gJ2ZpbGEnO1xuICAgICAgICAvLyBkMy5zZWxlY3QoYCMke3RoaXMudGl0bGVHcmFwaH1kYXRhYCkuYXR0cignY2xhc3MnLCAnZmlsYScpO1xuICAgICAgICBHcmFwaExpbmVDb21wb25lbnQucmVtb3ZlU3ZnJCh0aGlzLnRpdGxlR3JhcGgpO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0TGluZTEoKTogT2JzZXJ2YWJsZTxJQ29pbkhpc3Rvcnk+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPElDb2luSGlzdG9yeT4oKG9iKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxpbmVhMSA9IHRoaXMubGluZWFzWzBdO1xuICAgICAgICAgICAgb2IubmV4dCh0aGlzLmxpbmVhc1swXSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRUaXRsZXMoKTogT2JzZXJ2YWJsZTxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPHN0cmluZz4oKG9iKSA9PiB7XG4gICAgICAgICAgICBsZXQgdGl0bGVzID0gJyc7XG4gICAgICAgICAgICB0aGlzLmxpbmVhcy5mb3JFYWNoKChsaW5kYXRhKSA9PiB7XG4gICAgICAgICAgICBpZiAobGluZGF0YS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRpdGxlcyA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICB0aXRsZXMgPSBsaW5kYXRhLm5hbWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aXRsZXMgPSB0aXRsZXMgKyAnIC8gJyArIGxpbmRhdGEubmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudGl0bGVHcmFwaCA9IHRpdGxlcztcbiAgICAgICAgICAgIG9iLm5leHQodGl0bGVzKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIG5nT25Jbml0KCkge1xuXG4gICAgICAgIC8qIHRoaXMucmVtb3ZlU3ZnJCgpXG4gICAgICAgIC5waXBlKHN3aXRjaE1hcCgob2spID0+IHRoaXMuZ2V0VGl0bGVzKCkpXG4gICAgICAgICkgKi9cbiAgICAgICAgdGhpcy5nZXRUaXRsZXMoKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICAgIG1lcmdlTWFwKCgpID0+IHRoaXMuZ2V0TGluZTEoKSksXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gdGhpcy5kZWZpbmVDaGFydCQoKSksXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gZnJvbSh0aGlzLmxpbmVhcykpLFxuICAgICAgICAgICAgbWVyZ2VNYXAoKGxpbikgPT4gdGhpcy5kcmF3TGluZSQobGluKSksXG4gICAgICAgICAgICBkZWxheSgxMDAwKSxcbiAgICAgICAgICAgIGNvbmNhdE1hcCgoKSA9PiB0aGlzLmFkZFRvb2xUaXBzJCgpKSxcbiAgICAgICAgICAgIGNvbmNhdE1hcCgoKSA9PiB0aGlzLmFkZEV2ZW50c0FyZWEoKSksXG4gICAgICAgICAgICBjYXRjaEVycm9yKCgpID0+IG9mKCdlcnJvcicpKSxcbiAgICAgICAgKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgdGhpcy5hZGRUaXRsZUdyYXBoKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwdWJsaWMgZGVmaW5lQ2hhcnQkKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8Ym9vbGVhbj4oKG9iKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRlZmluZUNoYXJ0KCk7XG4gICAgICAgICAgICBvYi5uZXh0KHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcHVibGljIGRlZmluZUNoYXJ0KCkge1xuICAgICAgICBjb25zb2xlLmxvZygndGl0bGVHcmFwaDogJywgdGhpcy50aXRsZUdyYXBoKTtcbiAgICAgICAgdGhpcy5saW5lR3JhcGhFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmVjaGFydCcpO1xuICAgICAgICB0aGlzLnN2Z1ZpZXdwb3J0ID0gZDNcbiAgICAgICAgLnNlbGVjdCh0aGlzLmxpbmVHcmFwaEVsZW1lbnQpXG4gICAgICAgIC5hcHBlbmQoJ3N2ZycpXG4gICAgICAgIC5hdHRyKCdpZCcsIHRoaXMudGl0bGVHcmFwaClcbiAgICAgICAgLnN0eWxlKCdiYWNrZ3JvdW5kJywgJ3doaXRlJylcbiAgICAgICAgLmF0dHIoJ3ZpZXdCb3gnLCBgMCAwICR7dGhpcy5zdmdXaWR0aH0gJHt0aGlzLnN2Z0hlaWdodH1gKTtcbiAgICAgICAgdGhpcy5jaGFydFByb3BzLnhTY2FsZSA9IGQzXG4gICAgICAgIC5zY2FsZVRpbWUoKVxuICAgICAgICAuZG9tYWluKGQzLmV4dGVudCh0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheSwgKGQpID0+IG5ldyBEYXRlKGQudGltZXN0YW1wKS5nZXRUaW1lKCkpKVxuICAgICAgICAucmFuZ2UoWzAsIHRoaXMud2lkdGhdKVxuICAgICAgICAuY2xhbXAodHJ1ZSk7XG5cbiAgICAgICAgLy8gZGVzYWN0aXZvIGVsIHpvb20gZGVsIHN2ZyBwYXJhIHF1ZVxuICAgICAgICAvLyBubyBpbnRlcmZpZXJhIGNvbiBlbCB6b29tIGRlbCBsaW5lc3ZnXG4gICAgICAgIHRoaXMuc3ZnVmlld3BvcnQub24oJ21vdXNlZG93bi56b29tJywgbnVsbClcbiAgICAgICAgLm9uKCd0b3VjaHN0YXJ0Lnpvb20nLCBudWxsKVxuICAgICAgICAub24oJ3RvdWNobW92ZS56b29tJywgbnVsbClcbiAgICAgICAgLm9uKCd0b3VjaGVuZC56b29tJywgbnVsbCk7XG5cbiAgICAgICAgdGhpcy5jaGFydFByb3BzLnlTY2FsZSA9IGQzXG4gICAgICAgIC5zY2FsZUxpbmVhcigpXG4gICAgICAgIC5kb21haW4oW1xuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIGQzLm1heChcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVhcyxcbiAgICAgICAgICAgICAgICAoZCkgPT4gTWF0aC5tYXgoLi4uZC50aW1lUHJpY2VBcnJheS5tYXAoKHZhbHVlKSA9PiB2YWx1ZS5wcmljZSkpICogMS4xLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgXSlcbiAgICAgICAgLnJhbmdlKFt0aGlzLmhlaWdodCwgMF0pXG4gICAgICAgIC5jbGFtcCh0cnVlKTtcblxuICAgICAgICB0aGlzLnhBeGlzID0gZDMuYXhpc0JvdHRvbSh0aGlzLmNoYXJ0UHJvcHMueFNjYWxlKTtcbiAgICAgICAgdGhpcy55QXhpcyA9IGQzLmF4aXNMZWZ0KHRoaXMuY2hhcnRQcm9wcy55U2NhbGUpO1xuICAgICAgICB0aGlzLnpvb20gPSBkMy56b29tKClcbiAgICAgICAgLnNjYWxlRXh0ZW50KFsxLCBJbmZpbml0eV0pXG4gICAgICAgIC50cmFuc2xhdGVFeHRlbnQoW1swLCAwXSwgW3RoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XV0pXG4gICAgICAgIC5leHRlbnQoW1swLCAwXSwgW3RoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XV0pXG4gICAgICAgIC5vbignem9vbScsIHRoaXMuem9vbUZ1bmN0aW9uLmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMuaW5uZXJTcGFjZSA9IHRoaXMuc3ZnVmlld3BvcnRcbiAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgIC5hdHRyKCdjbGFzcycsICdpbm5lcl9zcGFjZScpXG4gICAgICAgIC5hdHRyKFxuICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgJ3RyYW5zbGF0ZSgnICsgdGhpcy5tYXJnaW4ubGVmdCArICcsJyArIHRoaXMubWFyZ2luLnRvcCArICcpJyxcbiAgICAgICAgKVxuICAgICAgICAuY2FsbCh0aGlzLnpvb20uYmluZCh0aGlzKSk7XG4gICAgICAgIGNvbnN0IGZvcm1hdEV2ZXJkID0gZDMudGltZUZvcm1hdCgnJWQvJW0gJUg6JU0nKTtcbiAgICAgICAgdGhpcy5nWCA9IHRoaXMuaW5uZXJTcGFjZVxuICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnYXhpcyBheGlzLS14JylcbiAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHRoaXMuaGVpZ2h0ICsgJyknKVxuICAgICAgICAgICAgLmNhbGwodGhpcy54QXhpcy50aWNrcyg2KS50aWNrRm9ybWF0KGZvcm1hdEV2ZXJkKSk7XG5cbiAgICAgICAgdGhpcy5nWSA9IHRoaXMuaW5uZXJTcGFjZVxuICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnYXhpcyBheGlzLS15JylcbiAgICAgICAgICAgIC5jYWxsKHRoaXMueUF4aXMpO1xuXG4gICAgICAgIHRoaXMub3JpZ2luYWxMaW5lID0gZDNcbiAgICAgICAgICAgIC5saW5lPElUaW1lUHJpY2U+KClcbiAgICAgICAgICAgIC54KChkKSA9PiB7XG4gICAgICAgICAgICBpZiAoZC50aW1lc3RhbXAgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2QuZGF0ZTogJywgZC5kYXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFydFByb3BzLnhTY2FsZShkLnRpbWVzdGFtcC5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC55KChkKSA9PiB0aGlzLmNoYXJ0UHJvcHMueVNjYWxlKGQucHJpY2UpKTtcblxuICAgICAgICB0aGlzLnNjYWxlZExpbmUgPSBkM1xuICAgICAgICAubGluZTxJVGltZVByaWNlPigpXG4gICAgICAgIC54KChkKSA9PiB7XG4gICAgICAgIGlmIChkLnRpbWVzdGFtcCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdkLmRhdGU6ICcsIGQuZGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZXd4U2NhbGUoZC50aW1lc3RhbXAuZ2V0VGltZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAueSgoZCkgPT4gdGhpcy5uZXd5U2NhbGUoZC5wcmljZSkpO1xuXG4gICAgICAgIGNvbnN0IHJlbW92ZVJlY3RhbmdsZSA9IHRoaXMuc3ZnVmlld3BvcnRcbiAgICAgICAgLmFwcGVuZCgncmVjdCcpXG4gICAgICAgIC5hdHRyKCd4JywgMClcbiAgICAgICAgLmF0dHIoJ3knLCAwKVxuICAgICAgICAuYXR0cignd2lkdGgnLCAzMClcbiAgICAgICAgLmF0dHIoJ2hlaWdodCcsIDMwKVxuICAgICAgICAuYXR0cignZmlsbCcsICdyZWQnKVxuICAgICAgICAub24oJ2NsaWNrJywgdGhpcy5vbmNsaWNrcmVtb3ZlLmJpbmQodGhpcykpO1xuXG4gICAgICAgIGNvbnN0IHJlbW92ZUFzcGExID0gdGhpcy5zdmdWaWV3cG9ydFxuICAgICAgICAuYXBwZW5kKCdsaW5lJylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2FzcGFzJylcbiAgICAgICAgLmF0dHIoJ3gxJywgMzApXG4gICAgICAgIC5hdHRyKCd4MicsIDApXG4gICAgICAgIC5hdHRyKCd5MScsIDApXG4gICAgICAgIC5hdHRyKCd5MicsIDMwKVxuICAgICAgICAuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xuXG4gICAgICAgIGNvbnN0IHJlbW92ZUFzcGEyID0gdGhpcy5zdmdWaWV3cG9ydFxuICAgICAgICAuYXBwZW5kKCdsaW5lJylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2FzcGFzJylcbiAgICAgICAgLmF0dHIoJ3gxJywgMClcbiAgICAgICAgLmF0dHIoJ3gyJywgMzApXG4gICAgICAgIC5hdHRyKCd5MScsIDApXG4gICAgICAgIC5hdHRyKCd5MicsIDMwKVxuICAgICAgICAuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpXG5cbiAgICAgICAgXG5cbiAgICAgICAgLyogZDMueG1sKGAke2NvbmZpZy51cmxTZXJ2ZXJ9L2Nsb3NlaWNvbi5zdmdgKVxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgcmVtb3ZlSWNvbi5ub2RlKCkuYXBwZW5kKGRhdGEuZG9jdW1lbnRFbGVtZW50KTtcbiAgICAgICAgfSk7ICovXG4gICAgfVxuICAgIHB1YmxpYyBhZGRFdmVudHNBcmVhKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8Ym9vbGVhbj4oKG9iKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSB0aGlzLmlubmVyU3BhY2VcbiAgICAgICAgICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3pvb20nKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgdGhpcy53aWR0aClcbiAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCB0aGlzLmhlaWdodClcbiAgICAgICAgICAgIC5vbignbW91c2VvdmVyJywgdGhpcy5tb3VzZW92ZXIuYmluZCh0aGlzKSlcbiAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1cy5zdHlsZSgnZGlzcGxheScsICdub25lJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9uKCdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlbW92ZS5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKCd0b3VjaHN0YXJ0JywgdGhpcy50b3VjaFN0YXJ0LmJpbmQodGhpcykpXG4gICAgICAgICAgICAub24oJ3RvdWNobW92ZScsIHRoaXMudG91Y2hNb3ZlLmJpbmQodGhpcykpXG4gICAgICAgICAgICAub24oJ3RvdWNoZW5kJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMuc3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBvYi5uZXh0KHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcHVibGljIGRyYXdMaW5lJChsaW5lOiBJQ29pbkhpc3RvcnkpIHtcbiAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxJQ29pbkhpc3Rvcnk+KChvYikgPT4ge1xuICAgICAgICAgIHRoaXMuZHJhd0xpbmUobGluZSk7XG4gICAgICAgICAgb2IubmV4dChsaW5lKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBwdWJsaWMgZHJhd0xpbmUobGluZTogSUNvaW5IaXN0b3J5KSB7XG4gICAgICAgIGxpbmUudGltZVByaWNlQXJyYXkuZm9yRWFjaCgocG9pbnQpID0+IHtcbiAgICAgICAgICAgIHBvaW50LnRpbWVzdGFtcCA9IG1vbWVudChwb2ludC50aW1lc3RhbXApLnRvRGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5saW5lU3ZnID0gdGhpcy5pbm5lclNwYWNlXG4gICAgICAgICAgICAuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAgIC5kYXR1bShsaW5lLnRpbWVQcmljZUFycmF5KVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xpbmVncmFwaCcpXG4gICAgICAgICAgICAvLyAuc3R5bGUoJ3N0cm9rZScsIGNvbG9yX2NvZGUpIC8vIGHDsWFkaXIgYXF1w60gZWwgY29sb3IgcXVlIHZpZW5lIGRlIGxvcyBkYXRvcyBkZSBsYSBsaW5lYVxuICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCAnYmxhY2snKVxuICAgICAgICAgICAgLmF0dHIoJ2QnLCB0aGlzLm9yaWdpbmFsTGluZS5iaW5kKHRoaXMpKGxpbmUudGltZVByaWNlQXJyYXkpKTtcbiAgICB9XG4gICAgcHVibGljIHpvb21GdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5uZXd4U2NhbGUgPSBkMy5ldmVudC50cmFuc2Zvcm0ucmVzY2FsZVgodGhpcy5jaGFydFByb3BzLnhTY2FsZSk7XG4gICAgICAgIHRoaXMubmV3eVNjYWxlID0gZDMuZXZlbnQudHJhbnNmb3JtLnJlc2NhbGVZKHRoaXMuY2hhcnRQcm9wcy55U2NhbGUpO1xuICAgICAgICAvLyB1cGRhdGUgYXhlc1xuICAgICAgICB0aGlzLmdYLmNhbGwodGhpcy54QXhpcy5zY2FsZSh0aGlzLm5ld3hTY2FsZSkpO1xuICAgICAgICB0aGlzLmdZLmNhbGwodGhpcy55QXhpcy5zY2FsZSh0aGlzLm5ld3lTY2FsZSkpO1xuICAgICAgICB0aGlzLmxpbmVTdmcuY2FsbCh0aGlzLnhBeGlzLnNjYWxlKHRoaXMubmV3eFNjYWxlKSk7XG4gICAgICAgIHRoaXMubGluZVN2Zy5jYWxsKHRoaXMueUF4aXMuc2NhbGUodGhpcy5uZXd5U2NhbGUpKTtcblxuICAgICAgICB0aGlzLmQzZXZlbnR0cmFuc2Zvcm0gPSBkMy5ldmVudC50cmFuc2Zvcm07XG4gICAgICAgIC8vIHRoaXMubGluZVN2Zy5hdHRyKCd0cmFuc2Zvcm0nLCB0aGlzLmQzZXZlbnR0cmFuc2Zvcm0pO1xuXG4gICAgICAgIC8vIHRoaXMuY2hhcnRQcm9wcy54U2NhbGUuZG9tYWluKG5ld0RvbWFpblgpO1xuICAgICAgICAvLyB0aGlzLmNoYXJ0UHJvcHMueVNjYWxlLmRvbWFpbihkMy5ldmVudC50cmFuc2Zvcm0ucmVzY2FsZVkodGhpcy5jaGFydFByb3BzLnlTY2FsZS5kb21haW4oKSkpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnc2UgZXNjYWxhJyk7XG5cbiAgICAgICAgdGhpcy5jaGFuZ2VMaW5lKCk7XG5cbiAgICAgICAgdGhpcy5tb3ZlVG9vbFRpcCgpO1xuXG4gICAgfVxuXG4gICAgcHVibGljIGNoYW5nZUxpbmUoKSB7XG4gICAgICAgIHRoaXMubGluZVN2Z1xuICAgICAgICAuYXR0cignZCcsIHRoaXMuc2NhbGVkTGluZS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvLyBjcmVhbW9zIGxhcyBmdW5jaW9uZXMgcXVlIGNyZWFuIGxvcyBjaXJjdWxvcyB5IGxvcyB0b29sdGlwc1xuXG4gICAgcHVibGljIGFkZFRpdGxlR3JhcGgoKSB7XG4gICAgICAvLyBlc3RlIGVzIGVsIHTDrXR1bG8gcXVlIGRlYmVyw61hIGFwYXJlY2VyIGRlYmFqbyBkZSBsYSBncsOhZmljYVxuICAgICAgLy8gY29ycmVnaW1vcyBlbCBtYXJnZW4gdG9wXG4gICAgICAvLyBjb25zdCBkaXN0VGV4dFRvcCA9IHRoaXMuaGVpZ2h0ICsgdGhpcy5tYXJnaW4udG9wO1xuICAgICAgY29uc3QgZGlzdFRleHRUb3AgPSAyNjA7XG4gICAgICAvLyBjb25zb2xlLmxvZygnZGlzdFRleHRUb3A6ICcsIGRpc3RUZXh0VG9wKTtcbiAgICAgIHRoaXMudGl0bGVTdmcgPSB0aGlzLmlubmVyU3BhY2VcbiAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgLmF0dHIoJ3gnLCB0aGlzLm1hcmdpbi5sZWZ0KVxuICAgICAgLy8gLmF0dHIoJ3knLCAwIC0gdGhpcy5tYXJnaW4udG9wIC8gNClcbiAgICAgIC5hdHRyKCd5JywgZGlzdFRleHRUb3ApXG4gICAgICAuYXR0cignY2xhc3MnLCAnZ3JhcGhpY190aXRsZV90ZXh0JylcbiAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdzdGFydCcpXG4gICAgICAudGV4dCh0aGlzLnRpdGxlR3JhcGgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhZGRUb29sVGlwcyQoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8Ym9vbGVhbj4oKG9iKSA9PiB7XG4gICAgICAgICAgdGhpcy5hZGRUb29sVGlwcygpO1xuICAgICAgICAgIG9iLm5leHQodHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcHVibGljIGFkZFRvb2xUaXBzKCkge1xuICAgICAgICB0aGlzLmZvY3VzID0gdGhpcy5pbm5lclNwYWNlXG4gICAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgICAuYXR0cignY2xhc3MnLCAndGhpcy5mb2N1cycpXG4gICAgICAgIC5zdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cbiAgICAgICAgdGhpcy5mb2N1c1xuICAgICAgICAuYXBwZW5kKCdsaW5lJylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3gtaG92ZXItbGluZSBob3Zlci1saW5lJylcbiAgICAgICAgLmF0dHIoJ3kxJywgMClcbiAgICAgICAgLmF0dHIoJ3kyJywgdGhpcy5oZWlnaHQpXG4gICAgICAgIC5hdHRyKCdwb2ludGVyLWV2ZW50cycsICdub25lJyk7XG5cbiAgICAgICAgdGhpcy5mb2N1c1xuICAgICAgICAuYXBwZW5kKCdsaW5lJylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3ktaG92ZXItbGluZSBob3Zlci1saW5lJylcbiAgICAgICAgLmF0dHIoJ3gxJywgMClcbiAgICAgICAgLmF0dHIoJ3gyJywgdGhpcy53aWR0aClcbiAgICAgICAgLmF0dHIoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTtcblxuICAgICAgICB0aGlzLmZvY3VzXG4gICAgICAgIC5hcHBlbmQoJ2NpcmNsZScpXG4gICAgICAgIC5hdHRyKCdyJywgMilcbiAgICAgICAgLmF0dHIoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTtcblxuICAgICAgICB0aGlzLnRleHRUb29sVGlwID0gdGhpcy5mb2N1c1xuICAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgLmF0dHIoJ2lkJywgJ3RleHRUb29sVGlwJylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3RleHRfdG9vbHRpcCcpXG4gICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdlbmQnKVxuICAgICAgICAuYXR0cigneScsIC0yMClcbiAgICAgICAgLmF0dHIoJ2R5JywgJy4zMWVtJyk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldERhdGFQb2ludCgpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5kKSB7XG4gICAgICAgICAgICBjb25zdCBob3JhID0gbW9tZW50KHRoaXMuZC50aW1lc3RhbXApLmZvcm1hdChjb25maWcudG9vbHRpcFRpbWVGb3JtYXQpO1xuICAgICAgICAgICAgY29uc3QgcHJlY2lvUmVkb25kZWFkbyA9IE1hdGgucm91bmQodGhpcy5kLnByaWNlICogMTAwKSAvIDEwMDtcbiAgICAgICAgICAgIGNvbnN0IHByZWNpb1RvTG9jYWxlID0gcHJlY2lvUmVkb25kZWFkby50b0xvY2FsZVN0cmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIGAke2hvcmF9OiAke3ByZWNpb1RvTG9jYWxlfeKCrGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJ25vIGRhdGEnO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyB0b3VjaE1vdmUoZGF0dW06IGFueSwgajogYW55LCBub2RlczogYW55KSB7XG4gICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjb25zdCBkID0gZDMudG91Y2hlcyhub2Rlc1tqXSk7XG5cbiAgICAgICAgdGhpcy5mb2N1cy5zdHlsZSgnZGlzcGxheScsIG51bGwpO1xuICAgICAgICB0aGlzLm1vdXNlbW92ZShkYXR1bSwgaiwgbm9kZXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyB0b3VjaFN0YXJ0KGRhdHVtOiBhbnksIGo6IGFueSwgbm9kZXM6IGFueSkge1xuICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgY29uc3QgZCA9IGQzLnRvdWNoZXMobm9kZXNbal0pO1xuXG4gICAgICAgIHRoaXMuZm9jdXMuc3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcbiAgICAgICAgdGhpcy5tb3VzZW1vdmUoZGF0dW0sIGosIG5vZGVzKTtcblxuICAgICAgICAvLyBkID0gZDMudG91Y2hlcyh0aGlzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbW91c2VvdmVyKGRhdHVtOiBhbnksIGo6IGFueSwgbm9kZXM6IGFueSkge1xuICAgICAgICBkMy5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIC8vIGQgPSBkMy50b3VjaGVzKHRoaXMpO1xuICAgICAgICB0aGlzLmZvY3VzLnN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG4gICAgICAgIHRoaXMubW91c2Vtb3ZlKGRhdHVtLCBqLCBub2Rlcyk7XG4gICAgfVxuXG4gICAgcHVibGljIG1vdXNlbW92ZShkYXR1bTogYW55LCBqOiBhbnksIG5vZGVzOiBhbnkpIHtcbiAgICAgICAgbGV0IHgwO1xuICAgICAgICBpZiAodGhpcy5uZXd4U2NhbGUpIHtcbiAgICAgICAgICAgIHgwID0gdGhpcy5uZXd4U2NhbGUuaW52ZXJ0KGQzLm1vdXNlKG5vZGVzW2pdKVswXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB4MCA9IHRoaXMuY2hhcnRQcm9wcy54U2NhbGUuaW52ZXJ0KGQzLm1vdXNlKG5vZGVzW2pdKVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaSA9IHRoaXMuYmlzZWN0RGF0ZSh0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheSwgeDAsIDEpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnaTogJywgaSk7XG5cbiAgICAgICAgY29uc3QgZDAgPSB0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheVtpIC0gMV07XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdkMDogJywgZDApO1xuXG4gICAgICAgIGNvbnN0IGFMZW5ndGggPSB0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheS5sZW5ndGg7XG4gICAgICAgIGxldCBkMTogSVRpbWVQcmljZTtcbiAgICAgICAgaWYgKGkgPj0gdGhpcy5saW5lYTEudGltZVByaWNlQXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICBkMSA9IHRoaXMubGluZWExLnRpbWVQcmljZUFycmF5W2FMZW5ndGggLSAxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGQxID0gdGhpcy5saW5lYTEudGltZVByaWNlQXJyYXlbaV07XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2QxOiAnLCBkMSk7XG5cbiAgICAgICAgdGhpcy5kID1cbiAgICAgICAgICAgIHgwLmdldFRpbWUoKSAtIChkMC50aW1lc3RhbXAgYXMgRGF0ZSkuZ2V0VGltZSgpID5cbiAgICAgICAgICAgIChkMS50aW1lc3RhbXAgYXMgRGF0ZSkuZ2V0VGltZSgpIC0geDAuZ2V0VGltZSgpXG4gICAgICAgICAgICA/IGQxXG4gICAgICAgICAgICA6IGQwO1xuICAgICAgICB0aGlzLm1vdmVUb29sVGlwKCk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgbW92ZVRvb2xUaXAoKSB7XG4gICAgICAgIGxldCBkaXN0YW5jaWF4OiBudW1iZXI7XG4gICAgICAgIGlmICh0aGlzLm5ld3hTY2FsZSkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c1xuICAgICAgICAgICAgLmF0dHIoXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybScsXG4gICAgICAgICAgICAgICAgYHRyYW5zbGF0ZSgke3RoaXMubmV3eFNjYWxlKFxuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSh0aGlzLmQudGltZXN0YW1wKSxcbiAgICAgICAgICAgICAgICApfSwke3RoaXMubmV3eVNjYWxlKHRoaXMuZC5wcmljZSl9KWApO1xuXG4gICAgICAgICAgICBkaXN0YW5jaWF4ID0gdGhpcy5uZXd4U2NhbGUobmV3IERhdGUodGhpcy5kLnRpbWVzdGFtcCkpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2Rpc3RhbmNpYXg6ICcsIGRpc3RhbmNpYXgpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzXG4gICAgICAgICAgICAuYXR0cihcbiAgICAgICAgICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgICAgICBgdHJhbnNsYXRlKCR7dGhpcy5jaGFydFByb3BzLnhTY2FsZShcbiAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUodGhpcy5kLnRpbWVzdGFtcCksXG4gICAgICAgICAgICAgICAgKX0sJHt0aGlzLmNoYXJ0UHJvcHMueVNjYWxlKHRoaXMuZC5wcmljZSl9KWApO1xuXG4gICAgICAgICAgICBkaXN0YW5jaWF4ID0gdGhpcy5jaGFydFByb3BzLnhTY2FsZShuZXcgRGF0ZSh0aGlzLmQudGltZXN0YW1wKSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGlzdGFuY2lheDogJywgZGlzdGFuY2lheCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGlmICh0aGlzLmQzZXZlbnR0cmFuc2Zvcm0pIHtcbiAgICAgICAgICB0aGlzLmZvY3VzLmF0dHIoXG4gICAgICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgIHRoaXMuZDNldmVudHRyYW5zZm9ybVxuICAgICAgICAgIClcbiAgICAgICAgfSAqL1xuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmNoYXJ0UHJvcHMueFNjYWxlKG5ldyBEYXRlKGQuZGF0ZSkpKTtcblxuICAgICAgICB0aGlzLnRleHRUb29sVGlwXG4gICAgICAgIC50ZXh0KHRoaXMuZ2V0RGF0YVBvaW50LmJpbmQodGhpcykpO1xuXG4gICAgICAgIGNvbnN0IHR4dE5vZGUgPSB0aGlzLnRleHRUb29sVGlwLm5vZGUoKSBhcyBTVkdUZXh0RWxlbWVudDtcblxuICAgICAgICBsZXQgYmJveDtcblxuICAgICAgICBiYm94ID0gdHh0Tm9kZS5nZXRCQm94KCk7XG5cbiAgICAgICAgaWYgKGJib3gud2lkdGggKyAxMCA+IGRpc3RhbmNpYXgpIHtcbiAgICAgICAgICAgIHRoaXMudGV4dFRvb2xUaXBcbiAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdzdGFydCcpO1xuICAgICAgICAgICAgYmJveCA9IHR4dE5vZGUuZ2V0QkJveCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50ZXh0VG9vbFRpcFxuICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ2VuZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5mb2N1cy5zZWxlY3RBbGwoJ3JlY3QnKS5yZW1vdmUoKTtcblxuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5mb2N1c1xuICAgICAgICAgICAgLmFwcGVuZCgncmVjdCcpXG4gICAgICAgICAgICAuYXR0cigneCcsIGJib3gueClcbiAgICAgICAgICAgIC5hdHRyKCd5JywgYmJveC55KVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgYmJveC53aWR0aClcbiAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBiYm94LmhlaWdodClcbiAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsICd3aGl0ZScpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZpbGwtb3BhY2l0eScsICcuOScpXG4gICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsICcjNjY2JylcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgJzAuNXB4Jyk7XG5cbiAgICAgICAgdGhpcy5mb2N1cy5ub2RlKCkuaW5zZXJ0QmVmb3JlKHR4dE5vZGUsIG51bGwpO1xuXG4gICAgICAgIGxldCBuZXd5MiA9IDA7XG5cbiAgICAgICAgaWYgKHRoaXMubmV3eVNjYWxlKSB7XG4gICAgICAgICAgICBuZXd5MiA9IHRoaXMubmV3eVNjYWxlKHRoaXMuZC5wcmljZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXd5MiA9IHRoaXMuY2hhcnRQcm9wcy55U2NhbGUodGhpcy5kLnByaWNlKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZXNjYWxvIGxhIHBvc2ljaW9uIHkyIGRlIGxhIGzDrW5lYSBzZWfDum4gbGEgbnVldmEgZXNjYWxhIHNpIHNlIGhhIGhlY2hvIHpvb21cbiAgICAgICAgdGhpcy5mb2N1c1xuICAgICAgICAgICAgLnNlbGVjdCgnLngtaG92ZXItbGluZScpXG4gICAgICAgICAgICAuYXR0cigneTInLCB0aGlzLmhlaWdodCAtIG5ld3kyKTtcblxuICAgICAgICAvLyBubyBmdW5jaW9uYSBsYSBsaW5lYSBob3Jpem9udGFsXG4gICAgICAgIHRoaXMuZm9jdXMuc2VsZWN0KCcueS1ob3Zlci1saW5lJykuYXR0cigneDInLCAtIGRpc3RhbmNpYXgpO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=