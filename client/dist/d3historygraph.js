(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{59:function(t,e,i){"use strict";i.r(e);var s=i(57),a=i(58),h=i(87),r=i(61),n=i(85),o=i(90),l=i(86),c=i(91),m=i(94),p=i(92),d=i(93);var u={date:"%d.%m.%Y",dateTime:"%a %b %e %X %Y",days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],periods:["AM","PM"],shortDays:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],shortMonths:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],time:"%H:%M:%S"},g=i(6);i.d(e,"GraphLineComponent",function(){return x}),s.timeFormatDefaultLocale(u);class x{constructor(t){this.lineas=t,this.d={price:0,timestamp:new Date},this.bisectDate=s.bisector(t=>t.timestamp).right,this.bisectValue=s.bisector(t=>t.price).right,this.svgWidth=800,this.svgHeight=300,this.margin={top:30,right:40,bottom:50,left:60},this.width=this.svgWidth-this.margin.left-this.margin.right,this.height=this.svgHeight-this.margin.top-this.margin.bottom,this.originalCircle={cx:-150,cy:-15,r:20},this.chartProps={},this.titleGraph="",this.ngOnInit()}removeSvg$(){return Object(h.a)(s.select("svg").remove()).pipe(Object(o.a)(!0))}getLine1(){return new r.a(t=>{this.linea1=this.lineas[0],t.next(this.lineas[0])})}getTitles(){return new r.a(t=>{let e="";this.lineas.forEach(t=>{t.name&&(e=""===e?t.name:e+" / "+t.name)}),this.titleGraph=e,t.next(e)})}ngOnInit(){this.getTitles().pipe(Object(l.a)(()=>this.getLine1()),Object(c.a)(()=>this.defineChart$()),Object(c.a)(()=>Object(n.a)(this.lineas)),Object(l.a)(t=>this.drawLine$(t)),Object(m.a)(1e3),Object(p.a)(()=>this.addToolTips$()),Object(p.a)(()=>this.addEventsArea()),Object(d.a)(()=>Object(h.a)("error"))).subscribe(()=>{this.addTitleGraph()})}defineChart$(){return new r.a(t=>{this.defineChart(),t.next(!0)})}defineChart(){this.lineGraphElement=document.getElementById("linechart"),this.svgViewport=s.select(this.lineGraphElement).append("svg").style("background","white").attr("viewBox",`0 0 ${this.svgWidth} ${this.svgHeight}`),this.chartProps.xScale=s.scaleTime().domain(s.extent(this.linea1.timePriceArray,t=>new Date(t.timestamp).getTime())).range([0,this.width]).clamp(!0),this.svgViewport.on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),this.chartProps.yScale=s.scaleLinear().domain([0,s.max(this.lineas,t=>1.1*Math.max(...t.timePriceArray.map(t=>t.price)))]).range([this.height,0]).clamp(!0),this.xAxis=s.axisBottom(this.chartProps.xScale),this.yAxis=s.axisLeft(this.chartProps.yScale),this.zoom=s.zoom().scaleExtent([1,1/0]).translateExtent([[0,0],[this.width,this.height]]).extent([[0,0],[this.width,this.height]]).on("zoom",this.zoomFunction.bind(this)),this.innerSpace=this.svgViewport.append("g").attr("class","inner_space").attr("transform","translate("+this.margin.left+","+this.margin.top+")").call(this.zoom.bind(this));const t=s.timeFormat("%d/%m %H:%M");this.gX=this.innerSpace.append("g").attr("class","axis axis--x").attr("transform","translate(0,"+this.height+")").call(this.xAxis.ticks(6).tickFormat(t)),this.gY=this.innerSpace.append("g").attr("class","axis axis--y").call(this.yAxis),this.originalLine=s.line().x(t=>{if(t.timestamp instanceof Date)return this.chartProps.xScale(t.timestamp.getTime())}).y(t=>this.chartProps.yScale(t.price)),this.scaledLine=s.line().x(t=>{if(t.timestamp instanceof Date)return this.newxScale(t.timestamp.getTime())}).y(t=>this.newyScale(t.price))}addEventsArea(){return new r.a(t=>{this.view=this.innerSpace.append("rect").attr("class","zoom").attr("width",this.width).attr("height",this.height).on("mouseover",this.mouseover.bind(this)).on("mouseout",()=>{this.focus.style("display","none")}).on("mousemove",this.mousemove.bind(this)).on("touchstart",this.touchStart.bind(this)).on("touchmove",this.touchMove.bind(this)).on("touchend",()=>{this.focus.style("display",null)}),t.next(!0)})}drawLine$(t){return new r.a(e=>{this.drawLine(t),e.next(t)})}drawLine(t){t.timePriceArray.forEach(t=>{t.timestamp=a(t.timestamp).toDate()}),this.lineSvg=this.innerSpace.append("path").datum(t.timePriceArray).attr("class","linegraph").style("stroke","black").attr("d",this.originalLine.bind(this)(t.timePriceArray))}zoomFunction(){this.newxScale=s.event.transform.rescaleX(this.chartProps.xScale),this.newyScale=s.event.transform.rescaleY(this.chartProps.yScale),this.gX.call(this.xAxis.scale(this.newxScale)),this.gY.call(this.yAxis.scale(this.newyScale)),this.lineSvg.call(this.xAxis.scale(this.newxScale)),this.lineSvg.call(this.yAxis.scale(this.newyScale)),this.d3eventtransform=s.event.transform,this.changeLine(),this.moveToolTip()}changeLine(){this.lineSvg.attr("d",this.scaledLine.bind(this))}addTitleGraph(){this.titleSvg=this.innerSpace.append("text").attr("x",this.margin.left).attr("y",260).attr("class","graphic_title_text").attr("text-anchor","end").text(this.titleGraph)}addToolTips$(){return new r.a(t=>{this.addToolTips(),t.next(!0)})}addToolTips(){this.focus=this.innerSpace.append("g").attr("class","this.focus").style("display","none"),this.focus.append("line").attr("class","x-hover-line hover-line").attr("y1",0).attr("y2",this.height).attr("pointer-events","none"),this.focus.append("line").attr("class","y-hover-line hover-line").attr("x1",0).attr("x2",this.width).attr("pointer-events","none"),this.focus.append("circle").attr("r",2).attr("pointer-events","none"),this.textToolTip=this.focus.append("text").attr("id","textToolTip").attr("class","text_tooltip").attr("text-anchor","end").attr("y",-20).attr("dy",".31em")}getDataPoint(){if(this.d){return`${a(this.d.timestamp).format(g.a.tooltipTimeFormat)}: ${(Math.round(100*this.d.price)/100).toLocaleString()}€`}return"no data"}touchMove(t,e,i){s.event.preventDefault(),s.event.stopPropagation();s.touches(i[e]);this.focus.style("display",null),this.mousemove(t,e,i)}touchStart(t,e,i){s.event.preventDefault(),s.event.stopPropagation();s.touches(i[e]);this.focus.style("display",null),this.mousemove(t,e,i)}mouseover(t,e,i){s.event.preventDefault(),s.event.stopPropagation(),this.focus.style("display",null),this.mousemove(t,e,i)}mousemove(t,e,i){let a;a=this.newxScale?this.newxScale.invert(s.mouse(i[e])[0]):this.chartProps.xScale.invert(s.mouse(i[e])[0]);const h=this.bisectDate(this.linea1.timePriceArray,a,1),r=this.linea1.timePriceArray[h-1],n=this.linea1.timePriceArray.length;let o;o=h>=this.linea1.timePriceArray.length?this.linea1.timePriceArray[n-1]:this.linea1.timePriceArray[h],this.d=a.getTime()-r.timestamp.getTime()>o.timestamp.getTime()-a.getTime()?o:r,this.moveToolTip()}moveToolTip(){let t;this.newxScale?(this.focus.attr("transform",`translate(${this.newxScale(new Date(this.d.timestamp))},${this.newyScale(this.d.price)})`),t=this.newxScale(new Date(this.d.timestamp))):(this.focus.attr("transform",`translate(${this.chartProps.xScale(new Date(this.d.timestamp))},${this.chartProps.yScale(this.d.price)})`),t=this.chartProps.xScale(new Date(this.d.timestamp))),this.textToolTip.text(this.getDataPoint.bind(this));const e=this.textToolTip.node();let i;(i=e.getBBox()).width+10>t?(this.textToolTip.attr("text-anchor","start"),i=e.getBBox()):this.textToolTip.attr("text-anchor","end"),this.focus.selectAll("rect").remove();this.focus.append("rect").attr("x",i.x).attr("y",i.y).attr("width",i.width).attr("height",i.height).style("fill","white").style("fill-opacity",".9").style("stroke","#666").style("stroke-width","0.5px");this.focus.node().insertBefore(e,null);let s=0;s=this.newyScale?this.newyScale(this.d.price):this.chartProps.yScale(this.d.price),this.focus.select(".x-hover-line").attr("y2",this.height-s),this.focus.select(".y-hover-line").attr("x2",-t)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZDMtdGltZWZvcm1hdGRlZmF1bHRsb2NhbGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2QzaGlzdG9yeWdyYXBoLnRzIl0sIm5hbWVzIjpbImQzX3RpbWVmb3JtYXRkZWZhdWx0bG9jYWxlIiwiZGF0ZSIsImRhdGVUaW1lIiwiZGF5cyIsIm1vbnRocyIsInBlcmlvZHMiLCJzaG9ydERheXMiLCJzaG9ydE1vbnRocyIsInRpbWUiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZCIsIl9fd2VicGFja19leHBvcnRzX18iLCJkM2hpc3RvcnlncmFwaF9HcmFwaExpbmVDb21wb25lbnQiLCJleHRlcm5hbF9kM18iLCJbb2JqZWN0IE9iamVjdF0iLCJsaW5lYXMiLCJ0aGlzIiwicHJpY2UiLCJ0aW1lc3RhbXAiLCJEYXRlIiwiYmlzZWN0RGF0ZSIsInJpZ2h0IiwiYmlzZWN0VmFsdWUiLCJzdmdXaWR0aCIsInN2Z0hlaWdodCIsIm1hcmdpbiIsInRvcCIsImJvdHRvbSIsImxlZnQiLCJ3aWR0aCIsImhlaWdodCIsIm9yaWdpbmFsQ2lyY2xlIiwiY3giLCJjeSIsInIiLCJjaGFydFByb3BzIiwidGl0bGVHcmFwaCIsIm5nT25Jbml0IiwiT2JqZWN0Iiwib2YiLCJyZW1vdmUiLCJwaXBlIiwibWFwVG8iLCJPYnNlcnZhYmxlIiwib2IiLCJsaW5lYTEiLCJuZXh0IiwidGl0bGVzIiwiZm9yRWFjaCIsImxpbmRhdGEiLCJuYW1lIiwiZ2V0VGl0bGVzIiwibWVyZ2VNYXAiLCJnZXRMaW5lMSIsInN3aXRjaE1hcCIsImRlZmluZUNoYXJ0JCIsImZyb20iLCJsaW4iLCJkcmF3TGluZSQiLCJkZWxheSIsImNvbmNhdE1hcCIsImFkZFRvb2xUaXBzJCIsImFkZEV2ZW50c0FyZWEiLCJjYXRjaEVycm9yIiwic3Vic2NyaWJlIiwiYWRkVGl0bGVHcmFwaCIsImRlZmluZUNoYXJ0IiwibGluZUdyYXBoRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdmdWaWV3cG9ydCIsImFwcGVuZCIsInN0eWxlIiwiYXR0ciIsInhTY2FsZSIsImRvbWFpbiIsInRpbWVQcmljZUFycmF5IiwiZ2V0VGltZSIsInJhbmdlIiwiY2xhbXAiLCJvbiIsInlTY2FsZSIsIk1hdGgiLCJtYXgiLCJtYXAiLCJ2YWx1ZSIsInhBeGlzIiwieUF4aXMiLCJ6b29tIiwic2NhbGVFeHRlbnQiLCJJbmZpbml0eSIsInRyYW5zbGF0ZUV4dGVudCIsImV4dGVudCIsInpvb21GdW5jdGlvbiIsImJpbmQiLCJpbm5lclNwYWNlIiwiY2FsbCIsImZvcm1hdEV2ZXJkIiwiZ1giLCJ0aWNrcyIsInRpY2tGb3JtYXQiLCJnWSIsIm9yaWdpbmFsTGluZSIsIngiLCJ5Iiwic2NhbGVkTGluZSIsIm5ld3hTY2FsZSIsIm5ld3lTY2FsZSIsInZpZXciLCJtb3VzZW92ZXIiLCJmb2N1cyIsIm1vdXNlbW92ZSIsInRvdWNoU3RhcnQiLCJ0b3VjaE1vdmUiLCJsaW5lIiwiZHJhd0xpbmUiLCJwb2ludCIsImV4dGVybmFsX21vbWVudF8iLCJ0b0RhdGUiLCJsaW5lU3ZnIiwiZGF0dW0iLCJ0cmFuc2Zvcm0iLCJyZXNjYWxlWCIsInJlc2NhbGVZIiwic2NhbGUiLCJkM2V2ZW50dHJhbnNmb3JtIiwiY2hhbmdlTGluZSIsIm1vdmVUb29sVGlwIiwidGl0bGVTdmciLCJ0ZXh0IiwiYWRkVG9vbFRpcHMiLCJ0ZXh0VG9vbFRpcCIsImZvcm1hdCIsImVudmlyb25tZW50IiwidG9vbHRpcFRpbWVGb3JtYXQiLCJyb3VuZCIsInRvTG9jYWxlU3RyaW5nIiwiaiIsIm5vZGVzIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJ4MCIsImludmVydCIsImkiLCJkMCIsImFMZW5ndGgiLCJsZW5ndGgiLCJkMSIsImRpc3RhbmNpYXgiLCJnZXREYXRhUG9pbnQiLCJ0eHROb2RlIiwibm9kZSIsImJib3giLCJnZXRCQm94Iiwic2VsZWN0QWxsIiwiaW5zZXJ0QmVmb3JlIiwibmV3eTIiLCJz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QkEsTUFBTSxTQUFVLFFBQ2hCQSxNQUFNLGVBQWdCLFNBRTNCeEQsS0FBSzhGLE1BQU15QyxPQUFPSSxhQUFhTCxFQUFTLE1BRXhDLElBQUlNLEVBQVEsRUFHUkEsRUFEQTVJLEtBQUsyRixVQUNHM0YsS0FBSzJGLFVBQVUzRixLQUFLTixFQUFFTyxPQUV0QkQsS0FBS21CLFdBQVc4QyxPQUFPakUsS0FBS04sRUFBRU8sT0FLMUNELEtBQUs4RixNQUNBK0MsT0FBTyxpQkFDUHBGLEtBQUssS0FBTXpELEtBQUtjLE9BQVM4SCxHQUc5QjVJLEtBQUs4RixNQUFNK0MsT0FBTyxpQkFBaUJwRixLQUFLLE1BQVEyRSIsImZpbGUiOiJkM2hpc3RvcnlncmFwaC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRpbWVMb2NhbGVEZWZpbml0aW9uIH0gZnJvbSAnZDMnO1xuXG5jb25zdCB0aW1lZm9ybWF0ZGVmYXVsdGxvY2FsZTogVGltZUxvY2FsZURlZmluaXRpb24gPSB7XG4gICAgZGF0ZTogJyVkLiVtLiVZJyxcbiAgICBkYXRlVGltZTogJyVhICViICVlICVYICVZJyxcbiAgICBkYXlzOiBbXG4gICAgICAnRG9taW5nbycsXG4gICAgICAnTHVuZXMnLFxuICAgICAgJ01hcnRlcycsXG4gICAgICAnTWnDqXJjb2xlcycsXG4gICAgICAnSnVldmVzJyxcbiAgICAgICdWaWVybmVzJyxcbiAgICAgICdTw6FiYWRvJyxcbiAgICBdLFxuICAgIG1vbnRoczogW1xuICAgICAgICAnRW5lcm8nLFxuICAgICAgICAnRmVicmVybycsXG4gICAgICAgICdNYXJ6bycsXG4gICAgICAgICdBYnJpbCcsXG4gICAgICAgICdNYXlvJyxcbiAgICAgICAgJ0p1bmlvJyxcbiAgICAgICAgJ0p1bGlvJyxcbiAgICAgICAgJ0Fnb3N0bycsXG4gICAgICAgICdTZXB0aWVtYnJlJyxcbiAgICAgICAgJ09jdHVicmUnLFxuICAgICAgICAnTm92aWVtYnJlJyxcbiAgICAgICAgJ0RpY2llbWJyZScsXG4gICAgXSxcbiAgICBwZXJpb2RzOiBbJ0FNJywgJ1BNJ10sXG4gICAgc2hvcnREYXlzOiBbJ0RvJywgJ0x1JywgJ01hJywgJ01pJywgJ0p1JywgJ1ZpJywgJ1NhJ10sXG4gICAgc2hvcnRNb250aHM6IFtcbiAgICAgICAgJ0VuZScsXG4gICAgICAgICdGZWInLFxuICAgICAgICAnTWFyJyxcbiAgICAgICAgJ0FicicsXG4gICAgICAgICdNYXknLFxuICAgICAgICAnSnVuJyxcbiAgICAgICAgJ0p1bCcsXG4gICAgICAgICdBZ28nLFxuICAgICAgICAnU2VwJyxcbiAgICAgICAgJ09jdCcsXG4gICAgICAgICdOb3YnLFxuICAgICAgICAnRGljJyxcbiAgICBdLFxuICAgIHRpbWU6ICclSDolTTolUycsXG59O1xuZXhwb3J0IGRlZmF1bHQgdGltZWZvcm1hdGRlZmF1bHRsb2NhbGU7XG4iLCJpbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQgKiBhcyBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IGZyb20sIE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBjYXRjaEVycm9yLCBjb25jYXRNYXAsIGRlbGF5LCBtYXBUbywgbWVyZ2VNYXAsIHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCBJQ29pbkhpc3RvcnkgZnJvbSAnLi9jb2luLWhpc3RvcnkuaW50ZXJmYWNlJztcbmltcG9ydCB0aW1lRm9ybWF0RGVmYXVsdExvY2FsZSBmcm9tICcuL2QzLXRpbWVmb3JtYXRkZWZhdWx0bG9jYWxlJztcbmltcG9ydCBJVGltZVByaWNlIGZyb20gJy4vdGltZXByaWNlLmludGVyZmFjZSc7XG5cbmltcG9ydCBjb25maWcgZnJvbSAnLi9lbnZpcm9ubWVudCc7XG5cbmQzLnRpbWVGb3JtYXREZWZhdWx0TG9jYWxlKHRpbWVGb3JtYXREZWZhdWx0TG9jYWxlKTtcblxuaW50ZXJmYWNlIElTY2FsZXMge1xuICB4U2NhbGU6IGQzLlNjYWxlVGltZTxudW1iZXIsIG51bWJlcj47XG4gIHlTY2FsZTogZDMuU2NhbGVMaW5lYXI8bnVtYmVyLCBudW1iZXI+O1xufVxuXG5leHBvcnQgY2xhc3MgR3JhcGhMaW5lQ29tcG9uZW50IHtcbiAgICBwdWJsaWMgZDogSVRpbWVQcmljZSA9IHtwcmljZTogMCwgdGltZXN0YW1wOiBuZXcgRGF0ZSgpfTtcbiAgICBwdWJsaWMgcGFuWDogYW55O1xuICAgIHB1YmxpYyBwYW5ZOiBhbnk7XG4gICAgcHVibGljIHNjYWxlTXVsdGlwbGllcjogYW55O1xuICAgIC8vIHB1YmxpYyBkM2V2ZW50dHJhbnNmb3JtOiBhbnkgPSB7IGs6IDEsIHg6IDAsIHk6IDAgfTtcbiAgICBwdWJsaWMgZDNldmVudHRyYW5zZm9ybTogYW55O1xuICAgIC8vIHB1YmxpYyBuZXd5U2NhbGU6IGQzLkF4aXNTY2FsZTxudW1iZXIgfCB7IHZhbHVlT2YoKTogbnVtYmVyOyB9PjtcbiAgICAvLyBwdWJsaWMgbmV3eFNjYWxlOiBkMy5BeGlzU2NhbGU8bnVtYmVyIHwgeyB2YWx1ZU9mKCk6IG51bWJlcjsgfT47XG4gICAgcHVibGljIG5ld3lTY2FsZTogYW55OyAvLyBhc2lnbmFyIGVuIGVsIGNvbnRydWN0b3IgbyBlcXVpdmFsZW50ZVxuICAgIHB1YmxpYyBuZXd4U2NhbGU6IGFueTtcbiAgICBwdWJsaWMgYmlzZWN0RGF0ZSA9IGQzLmJpc2VjdG9yKChkOiBJVGltZVByaWNlKSA9PiBkLnRpbWVzdGFtcCkucmlnaHQ7XG4gICAgcHVibGljIGJpc2VjdFZhbHVlID0gZDMuYmlzZWN0b3IoKGQ6IElUaW1lUHJpY2UpID0+IGQucHJpY2UpLnJpZ2h0O1xuICAgIHB1YmxpYyBzdmdXaWR0aCA9IDgwMDtcbiAgICBwdWJsaWMgc3ZnSGVpZ2h0ID0gMzAwO1xuICAgIHB1YmxpYyBtYXJnaW4gPSB7IHRvcDogMzAsIHJpZ2h0OiA0MCwgYm90dG9tOiA1MCwgbGVmdDogNjAgfTtcbiAgICBwdWJsaWMgd2lkdGggPSB0aGlzLnN2Z1dpZHRoIC0gdGhpcy5tYXJnaW4ubGVmdCAtIHRoaXMubWFyZ2luLnJpZ2h0O1xuICAgIHB1YmxpYyBoZWlnaHQgPSB0aGlzLnN2Z0hlaWdodCAtIHRoaXMubWFyZ2luLnRvcCAtIHRoaXMubWFyZ2luLmJvdHRvbTtcbiAgICBwdWJsaWMgb3JpZ2luYWxMaW5lOiBkMy5MaW5lPElUaW1lUHJpY2U+O1xuICAgIHB1YmxpYyBzY2FsZWRMaW5lOiBkMy5MaW5lPElUaW1lUHJpY2U+O1xuICAgIHB1YmxpYyBvcmlnaW5hbENpcmNsZSA9IHtcbiAgICBjeDogLTE1MCxcbiAgICBjeTogLTE1LFxuICAgIHI6IDIwLFxuICAgIH07XG4gICAgcHVibGljIGNoYXJ0UHJvcHMgPSB7fSBhcyBJU2NhbGVzO1xuICAgIHB1YmxpYyBnWDogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCB7fSwgbnVsbCwgdW5kZWZpbmVkPjtcbiAgICBwdWJsaWMgZ1k6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIGxpbmVTdmc6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIHZpZXc6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIGlubmVyU3BhY2U6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIHN2Z1ZpZXdwb3J0OiBkMy5TZWxlY3Rpb248U1ZHR0VsZW1lbnQsIHt9LCBudWxsLCB1bmRlZmluZWQ+O1xuICAgIHB1YmxpYyB0aXRsZVN2ZzogZDMuU2VsZWN0aW9uPFNWR0dFbGVtZW50LCB7fSwgbnVsbCwgdW5kZWZpbmVkPjtcbiAgICBwdWJsaWMgZm9jdXM6IGQzLlNlbGVjdGlvbjxTVkdHRWxlbWVudCwge30sIG51bGwsIHVuZGVmaW5lZD47XG4gICAgcHVibGljIHRleHRUb29sVGlwOiBkMy5TZWxlY3Rpb248U1ZHVGV4dEVsZW1lbnQsIHt9LCBudWxsLCB1bmRlZmluZWQ+O1xuICAgIHB1YmxpYyB6b29tOiBkMy5ab29tQmVoYXZpb3I8RWxlbWVudCwge30+O1xuICAgIHB1YmxpYyB4QXhpczogZDMuQXhpczxudW1iZXIgfCB7IHZhbHVlT2YoKTogbnVtYmVyIH0+O1xuICAgIHB1YmxpYyB5QXhpczogZDMuQXhpczxudW1iZXIgfCB7IHZhbHVlT2YoKTogbnVtYmVyIH0+O1xuICAgIHB1YmxpYyBsaW5lR3JhcGhFbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgICBwdWJsaWMgbGluZWExOiBJQ29pbkhpc3Rvcnk7XG4gICAgcHVibGljIHRpdGxlR3JhcGggPSAnJztcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGxpbmVhczogSUNvaW5IaXN0b3J5W10sXG4gICAgKSB7XG4gICAgICAgIHRoaXMubmdPbkluaXQoKTtcbiAgICB9XG4gICAgcHVibGljIHJlbW92ZVN2ZyQoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgICAgIHJldHVybiBvZihkMy5zZWxlY3QoJ3N2ZycpLnJlbW92ZSgpKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICAgIG1hcFRvKHRydWUpLFxuICAgICAgICApO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0TGluZTEoKTogT2JzZXJ2YWJsZTxJQ29pbkhpc3Rvcnk+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPElDb2luSGlzdG9yeT4oKG9iKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxpbmVhMSA9IHRoaXMubGluZWFzWzBdO1xuICAgICAgICAgICAgb2IubmV4dCh0aGlzLmxpbmVhc1swXSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRUaXRsZXMoKTogT2JzZXJ2YWJsZTxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPHN0cmluZz4oKG9iKSA9PiB7XG4gICAgICAgICAgICBsZXQgdGl0bGVzID0gJyc7XG4gICAgICAgICAgICB0aGlzLmxpbmVhcy5mb3JFYWNoKChsaW5kYXRhKSA9PiB7XG4gICAgICAgICAgICBpZiAobGluZGF0YS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRpdGxlcyA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICB0aXRsZXMgPSBsaW5kYXRhLm5hbWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aXRsZXMgPSB0aXRsZXMgKyAnIC8gJyArIGxpbmRhdGEubmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudGl0bGVHcmFwaCA9IHRpdGxlcztcbiAgICAgICAgICAgIG9iLm5leHQodGl0bGVzKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIG5nT25Jbml0KCkge1xuXG4gICAgICAgIC8qIHRoaXMucmVtb3ZlU3ZnJCgpXG4gICAgICAgIC5waXBlKHN3aXRjaE1hcCgob2spID0+IHRoaXMuZ2V0VGl0bGVzKCkpXG4gICAgICAgICkgKi9cbiAgICAgICAgdGhpcy5nZXRUaXRsZXMoKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICAgIG1lcmdlTWFwKCgpID0+IHRoaXMuZ2V0TGluZTEoKSksXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gdGhpcy5kZWZpbmVDaGFydCQoKSksXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gZnJvbSh0aGlzLmxpbmVhcykpLFxuICAgICAgICAgICAgbWVyZ2VNYXAoKGxpbikgPT4gdGhpcy5kcmF3TGluZSQobGluKSksXG4gICAgICAgICAgICBkZWxheSgxMDAwKSxcbiAgICAgICAgICAgIGNvbmNhdE1hcCgoKSA9PiB0aGlzLmFkZFRvb2xUaXBzJCgpKSxcbiAgICAgICAgICAgIGNvbmNhdE1hcCgoKSA9PiB0aGlzLmFkZEV2ZW50c0FyZWEoKSksXG4gICAgICAgICAgICBjYXRjaEVycm9yKCgpID0+IG9mKCdlcnJvcicpKSxcbiAgICAgICAgKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgdGhpcy5hZGRUaXRsZUdyYXBoKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwdWJsaWMgZGVmaW5lQ2hhcnQkKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8Ym9vbGVhbj4oKG9iKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRlZmluZUNoYXJ0KCk7XG4gICAgICAgICAgICBvYi5uZXh0KHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcHVibGljIGRlZmluZUNoYXJ0KCkge1xuICAgICAgICB0aGlzLmxpbmVHcmFwaEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZWNoYXJ0Jyk7XG4gICAgICAgIHRoaXMuc3ZnVmlld3BvcnQgPSBkM1xuICAgICAgICAuc2VsZWN0KHRoaXMubGluZUdyYXBoRWxlbWVudClcbiAgICAgICAgLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgLnN0eWxlKCdiYWNrZ3JvdW5kJywgJ3doaXRlJylcbiAgICAgICAgLmF0dHIoJ3ZpZXdCb3gnLCBgMCAwICR7dGhpcy5zdmdXaWR0aH0gJHt0aGlzLnN2Z0hlaWdodH1gKTtcbiAgICAgICAgdGhpcy5jaGFydFByb3BzLnhTY2FsZSA9IGQzXG4gICAgICAgIC5zY2FsZVRpbWUoKVxuICAgICAgICAuZG9tYWluKGQzLmV4dGVudCh0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheSwgKGQpID0+IG5ldyBEYXRlKGQudGltZXN0YW1wKS5nZXRUaW1lKCkpKVxuICAgICAgICAucmFuZ2UoWzAsIHRoaXMud2lkdGhdKVxuICAgICAgICAuY2xhbXAodHJ1ZSk7XG5cbiAgICAgICAgLy8gZGVzYWN0aXZvIGVsIHpvb20gZGVsIHN2ZyBwYXJhIHF1ZVxuICAgICAgICAvLyBubyBpbnRlcmZpZXJhIGNvbiBlbCB6b29tIGRlbCBsaW5lc3ZnXG4gICAgICAgIHRoaXMuc3ZnVmlld3BvcnQub24oJ21vdXNlZG93bi56b29tJywgbnVsbClcbiAgICAgICAgLm9uKCd0b3VjaHN0YXJ0Lnpvb20nLCBudWxsKVxuICAgICAgICAub24oJ3RvdWNobW92ZS56b29tJywgbnVsbClcbiAgICAgICAgLm9uKCd0b3VjaGVuZC56b29tJywgbnVsbCk7XG5cbiAgICAgICAgdGhpcy5jaGFydFByb3BzLnlTY2FsZSA9IGQzXG4gICAgICAgIC5zY2FsZUxpbmVhcigpXG4gICAgICAgIC5kb21haW4oW1xuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIGQzLm1heChcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVhcyxcbiAgICAgICAgICAgICAgICAoZCkgPT4gTWF0aC5tYXgoLi4uZC50aW1lUHJpY2VBcnJheS5tYXAoKHZhbHVlKSA9PiB2YWx1ZS5wcmljZSkpICogMS4xLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgXSlcbiAgICAgICAgLnJhbmdlKFt0aGlzLmhlaWdodCwgMF0pXG4gICAgICAgIC5jbGFtcCh0cnVlKTtcblxuICAgICAgICB0aGlzLnhBeGlzID0gZDMuYXhpc0JvdHRvbSh0aGlzLmNoYXJ0UHJvcHMueFNjYWxlKTtcbiAgICAgICAgdGhpcy55QXhpcyA9IGQzLmF4aXNMZWZ0KHRoaXMuY2hhcnRQcm9wcy55U2NhbGUpO1xuICAgICAgICB0aGlzLnpvb20gPSBkMy56b29tKClcbiAgICAgICAgLnNjYWxlRXh0ZW50KFsxLCBJbmZpbml0eV0pXG4gICAgICAgIC50cmFuc2xhdGVFeHRlbnQoW1swLCAwXSwgW3RoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XV0pXG4gICAgICAgIC5leHRlbnQoW1swLCAwXSwgW3RoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XV0pXG4gICAgICAgIC5vbignem9vbScsIHRoaXMuem9vbUZ1bmN0aW9uLmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMuaW5uZXJTcGFjZSA9IHRoaXMuc3ZnVmlld3BvcnRcbiAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgIC5hdHRyKCdjbGFzcycsICdpbm5lcl9zcGFjZScpXG4gICAgICAgIC5hdHRyKFxuICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgJ3RyYW5zbGF0ZSgnICsgdGhpcy5tYXJnaW4ubGVmdCArICcsJyArIHRoaXMubWFyZ2luLnRvcCArICcpJyxcbiAgICAgICAgKVxuICAgICAgICAuY2FsbCh0aGlzLnpvb20uYmluZCh0aGlzKSk7XG4gICAgICAgIGNvbnN0IGZvcm1hdEV2ZXJkID0gZDMudGltZUZvcm1hdCgnJWQvJW0gJUg6JU0nKTtcbiAgICAgICAgdGhpcy5nWCA9IHRoaXMuaW5uZXJTcGFjZVxuICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnYXhpcyBheGlzLS14JylcbiAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIHRoaXMuaGVpZ2h0ICsgJyknKVxuICAgICAgICAgICAgLmNhbGwodGhpcy54QXhpcy50aWNrcyg2KS50aWNrRm9ybWF0KGZvcm1hdEV2ZXJkKSk7XG5cbiAgICAgICAgdGhpcy5nWSA9IHRoaXMuaW5uZXJTcGFjZVxuICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnYXhpcyBheGlzLS15JylcbiAgICAgICAgICAgIC5jYWxsKHRoaXMueUF4aXMpO1xuXG4gICAgICAgIHRoaXMub3JpZ2luYWxMaW5lID0gZDNcbiAgICAgICAgICAgIC5saW5lPElUaW1lUHJpY2U+KClcbiAgICAgICAgICAgIC54KChkKSA9PiB7XG4gICAgICAgICAgICBpZiAoZC50aW1lc3RhbXAgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2QuZGF0ZTogJywgZC5kYXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFydFByb3BzLnhTY2FsZShkLnRpbWVzdGFtcC5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC55KChkKSA9PiB0aGlzLmNoYXJ0UHJvcHMueVNjYWxlKGQucHJpY2UpKTtcblxuICAgICAgICB0aGlzLnNjYWxlZExpbmUgPSBkM1xuICAgICAgICAubGluZTxJVGltZVByaWNlPigpXG4gICAgICAgIC54KChkKSA9PiB7XG4gICAgICAgIGlmIChkLnRpbWVzdGFtcCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdkLmRhdGU6ICcsIGQuZGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZXd4U2NhbGUoZC50aW1lc3RhbXAuZ2V0VGltZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAueSgoZCkgPT4gdGhpcy5uZXd5U2NhbGUoZC5wcmljZSkpO1xuICAgIH1cbiAgICBwdWJsaWMgYWRkRXZlbnRzQXJlYSgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPGJvb2xlYW4+KChvYikgPT4ge1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gdGhpcy5pbm5lclNwYWNlXG4gICAgICAgICAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd6b29tJylcbiAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHRoaXMud2lkdGgpXG4gICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgdGhpcy5oZWlnaHQpXG4gICAgICAgICAgICAub24oJ21vdXNlb3ZlcicsIHRoaXMubW91c2VvdmVyLmJpbmQodGhpcykpXG4gICAgICAgICAgICAub24oJ21vdXNlb3V0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbignbW91c2Vtb3ZlJywgdGhpcy5tb3VzZW1vdmUuYmluZCh0aGlzKSlcbiAgICAgICAgICAgIC5vbigndG91Y2hzdGFydCcsIHRoaXMudG91Y2hTdGFydC5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKCd0b3VjaG1vdmUnLCB0aGlzLnRvdWNoTW92ZS5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKCd0b3VjaGVuZCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzLnN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgb2IubmV4dCh0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHB1YmxpYyBkcmF3TGluZSQobGluZTogSUNvaW5IaXN0b3J5KSB7XG4gICAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8SUNvaW5IaXN0b3J5Pigob2IpID0+IHtcbiAgICAgICAgICB0aGlzLmRyYXdMaW5lKGxpbmUpO1xuICAgICAgICAgIG9iLm5leHQobGluZSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcHVibGljIGRyYXdMaW5lKGxpbmU6IElDb2luSGlzdG9yeSkge1xuICAgICAgICBsaW5lLnRpbWVQcmljZUFycmF5LmZvckVhY2goKHBvaW50KSA9PiB7XG4gICAgICAgICAgICBwb2ludC50aW1lc3RhbXAgPSBtb21lbnQocG9pbnQudGltZXN0YW1wKS50b0RhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGluZVN2ZyA9IHRoaXMuaW5uZXJTcGFjZVxuICAgICAgICAgICAgLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAuZGF0dW0obGluZS50aW1lUHJpY2VBcnJheSlcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsaW5lZ3JhcGgnKVxuICAgICAgICAgICAgLy8gLnN0eWxlKCdzdHJva2UnLCBjb2xvcl9jb2RlKSAvLyBhw7FhZGlyIGFxdcOtIGVsIGNvbG9yIHF1ZSB2aWVuZSBkZSBsb3MgZGF0b3MgZGUgbGEgbGluZWFcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJ2JsYWNrJylcbiAgICAgICAgICAgIC5hdHRyKCdkJywgdGhpcy5vcmlnaW5hbExpbmUuYmluZCh0aGlzKShsaW5lLnRpbWVQcmljZUFycmF5KSk7XG4gICAgfVxuICAgIHB1YmxpYyB6b29tRnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubmV3eFNjYWxlID0gZDMuZXZlbnQudHJhbnNmb3JtLnJlc2NhbGVYKHRoaXMuY2hhcnRQcm9wcy54U2NhbGUpO1xuICAgICAgICB0aGlzLm5ld3lTY2FsZSA9IGQzLmV2ZW50LnRyYW5zZm9ybS5yZXNjYWxlWSh0aGlzLmNoYXJ0UHJvcHMueVNjYWxlKTtcbiAgICAgICAgLy8gdXBkYXRlIGF4ZXNcbiAgICAgICAgdGhpcy5nWC5jYWxsKHRoaXMueEF4aXMuc2NhbGUodGhpcy5uZXd4U2NhbGUpKTtcbiAgICAgICAgdGhpcy5nWS5jYWxsKHRoaXMueUF4aXMuc2NhbGUodGhpcy5uZXd5U2NhbGUpKTtcbiAgICAgICAgdGhpcy5saW5lU3ZnLmNhbGwodGhpcy54QXhpcy5zY2FsZSh0aGlzLm5ld3hTY2FsZSkpO1xuICAgICAgICB0aGlzLmxpbmVTdmcuY2FsbCh0aGlzLnlBeGlzLnNjYWxlKHRoaXMubmV3eVNjYWxlKSk7XG5cbiAgICAgICAgdGhpcy5kM2V2ZW50dHJhbnNmb3JtID0gZDMuZXZlbnQudHJhbnNmb3JtO1xuICAgICAgICAvLyB0aGlzLmxpbmVTdmcuYXR0cigndHJhbnNmb3JtJywgdGhpcy5kM2V2ZW50dHJhbnNmb3JtKTtcblxuICAgICAgICAvLyB0aGlzLmNoYXJ0UHJvcHMueFNjYWxlLmRvbWFpbihuZXdEb21haW5YKTtcbiAgICAgICAgLy8gdGhpcy5jaGFydFByb3BzLnlTY2FsZS5kb21haW4oZDMuZXZlbnQudHJhbnNmb3JtLnJlc2NhbGVZKHRoaXMuY2hhcnRQcm9wcy55U2NhbGUuZG9tYWluKCkpKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3NlIGVzY2FsYScpO1xuXG4gICAgICAgIHRoaXMuY2hhbmdlTGluZSgpO1xuXG4gICAgICAgIHRoaXMubW92ZVRvb2xUaXAoKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBjaGFuZ2VMaW5lKCkge1xuICAgICAgICB0aGlzLmxpbmVTdmdcbiAgICAgICAgLmF0dHIoJ2QnLCB0aGlzLnNjYWxlZExpbmUuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgLy8gY3JlYW1vcyBsYXMgZnVuY2lvbmVzIHF1ZSBjcmVhbiBsb3MgY2lyY3Vsb3MgeSBsb3MgdG9vbHRpcHNcblxuICAgIHB1YmxpYyBhZGRUaXRsZUdyYXBoKCkge1xuICAgICAgLy8gZXN0ZSBlcyBlbCB0w610dWxvIHF1ZSBkZWJlcsOtYSBhcGFyZWNlciBkZWJham8gZGUgbGEgZ3LDoWZpY2FcbiAgICAgIC8vIGNvcnJlZ2ltb3MgZWwgbWFyZ2VuIHRvcFxuICAgICAgLy8gY29uc3QgZGlzdFRleHRUb3AgPSB0aGlzLmhlaWdodCArIHRoaXMubWFyZ2luLnRvcDtcbiAgICAgIGNvbnN0IGRpc3RUZXh0VG9wID0gMjYwO1xuICAgICAgLy8gY29uc29sZS5sb2coJ2Rpc3RUZXh0VG9wOiAnLCBkaXN0VGV4dFRvcCk7XG4gICAgICB0aGlzLnRpdGxlU3ZnID0gdGhpcy5pbm5lclNwYWNlXG4gICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgIC5hdHRyKCd4JywgdGhpcy5tYXJnaW4ubGVmdClcbiAgICAgIC8vIC5hdHRyKCd5JywgMCAtIHRoaXMubWFyZ2luLnRvcCAvIDQpXG4gICAgICAuYXR0cigneScsIGRpc3RUZXh0VG9wKVxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ2dyYXBoaWNfdGl0bGVfdGV4dCcpXG4gICAgICAuYXR0cigndGV4dC1hbmNob3InLCAnZW5kJylcbiAgICAgIC50ZXh0KHRoaXMudGl0bGVHcmFwaCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZFRvb2xUaXBzJCgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxib29sZWFuPigob2IpID0+IHtcbiAgICAgICAgICB0aGlzLmFkZFRvb2xUaXBzKCk7XG4gICAgICAgICAgb2IubmV4dCh0cnVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBwdWJsaWMgYWRkVG9vbFRpcHMoKSB7XG4gICAgICAgIHRoaXMuZm9jdXMgPSB0aGlzLmlubmVyU3BhY2VcbiAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgIC5hdHRyKCdjbGFzcycsICd0aGlzLmZvY3VzJylcbiAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblxuICAgICAgICB0aGlzLmZvY3VzXG4gICAgICAgIC5hcHBlbmQoJ2xpbmUnKVxuICAgICAgICAuYXR0cignY2xhc3MnLCAneC1ob3Zlci1saW5lIGhvdmVyLWxpbmUnKVxuICAgICAgICAuYXR0cigneTEnLCAwKVxuICAgICAgICAuYXR0cigneTInLCB0aGlzLmhlaWdodClcbiAgICAgICAgLmF0dHIoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTtcblxuICAgICAgICB0aGlzLmZvY3VzXG4gICAgICAgIC5hcHBlbmQoJ2xpbmUnKVxuICAgICAgICAuYXR0cignY2xhc3MnLCAneS1ob3Zlci1saW5lIGhvdmVyLWxpbmUnKVxuICAgICAgICAuYXR0cigneDEnLCAwKVxuICAgICAgICAuYXR0cigneDInLCB0aGlzLndpZHRoKVxuICAgICAgICAuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xuXG4gICAgICAgIHRoaXMuZm9jdXNcbiAgICAgICAgLmFwcGVuZCgnY2lyY2xlJylcbiAgICAgICAgLmF0dHIoJ3InLCAyKVxuICAgICAgICAuYXR0cigncG9pbnRlci1ldmVudHMnLCAnbm9uZScpO1xuXG4gICAgICAgIHRoaXMudGV4dFRvb2xUaXAgPSB0aGlzLmZvY3VzXG4gICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAuYXR0cignaWQnLCAndGV4dFRvb2xUaXAnKVxuICAgICAgICAuYXR0cignY2xhc3MnLCAndGV4dF90b29sdGlwJylcbiAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ2VuZCcpXG4gICAgICAgIC5hdHRyKCd5JywgLTIwKVxuICAgICAgICAuYXR0cignZHknLCAnLjMxZW0nKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0RGF0YVBvaW50KCk6IHN0cmluZyB7XG4gICAgICAgIGlmICh0aGlzLmQpIHtcbiAgICAgICAgICAgIGNvbnN0IGhvcmEgPSBtb21lbnQodGhpcy5kLnRpbWVzdGFtcCkuZm9ybWF0KGNvbmZpZy50b29sdGlwVGltZUZvcm1hdCk7XG4gICAgICAgICAgICBjb25zdCBwcmVjaW9SZWRvbmRlYWRvID0gTWF0aC5yb3VuZCh0aGlzLmQucHJpY2UgKiAxMDApIC8gMTAwO1xuICAgICAgICAgICAgY29uc3QgcHJlY2lvVG9Mb2NhbGUgPSBwcmVjaW9SZWRvbmRlYWRvLnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgICAgICAgICByZXR1cm4gYCR7aG9yYX06ICR7cHJlY2lvVG9Mb2NhbGV94oKsYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnbm8gZGF0YSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHVibGljIHRvdWNoTW92ZShkYXR1bTogYW55LCBqOiBhbnksIG5vZGVzOiBhbnkpIHtcbiAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZDMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGNvbnN0IGQgPSBkMy50b3VjaGVzKG5vZGVzW2pdKTtcblxuICAgICAgICB0aGlzLmZvY3VzLnN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG4gICAgICAgIHRoaXMubW91c2Vtb3ZlKGRhdHVtLCBqLCBub2Rlcyk7XG4gICAgfVxuXG4gICAgcHVibGljIHRvdWNoU3RhcnQoZGF0dW06IGFueSwgajogYW55LCBub2RlczogYW55KSB7XG4gICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjb25zdCBkID0gZDMudG91Y2hlcyhub2Rlc1tqXSk7XG5cbiAgICAgICAgdGhpcy5mb2N1cy5zdHlsZSgnZGlzcGxheScsIG51bGwpO1xuICAgICAgICB0aGlzLm1vdXNlbW92ZShkYXR1bSwgaiwgbm9kZXMpO1xuXG4gICAgICAgIC8vIGQgPSBkMy50b3VjaGVzKHRoaXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBtb3VzZW92ZXIoZGF0dW06IGFueSwgajogYW55LCBub2RlczogYW55KSB7XG4gICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgLy8gZCA9IGQzLnRvdWNoZXModGhpcyk7XG4gICAgICAgIHRoaXMuZm9jdXMuc3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcbiAgICAgICAgdGhpcy5tb3VzZW1vdmUoZGF0dW0sIGosIG5vZGVzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbW91c2Vtb3ZlKGRhdHVtOiBhbnksIGo6IGFueSwgbm9kZXM6IGFueSkge1xuICAgICAgICBsZXQgeDA7XG4gICAgICAgIGlmICh0aGlzLm5ld3hTY2FsZSkge1xuICAgICAgICAgICAgeDAgPSB0aGlzLm5ld3hTY2FsZS5pbnZlcnQoZDMubW91c2Uobm9kZXNbal0pWzBdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHgwID0gdGhpcy5jaGFydFByb3BzLnhTY2FsZS5pbnZlcnQoZDMubW91c2Uobm9kZXNbal0pWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpID0gdGhpcy5iaXNlY3REYXRlKHRoaXMubGluZWExLnRpbWVQcmljZUFycmF5LCB4MCwgMSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdpOiAnLCBpKTtcblxuICAgICAgICBjb25zdCBkMCA9IHRoaXMubGluZWExLnRpbWVQcmljZUFycmF5W2kgLSAxXTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2QwOiAnLCBkMCk7XG5cbiAgICAgICAgY29uc3QgYUxlbmd0aCA9IHRoaXMubGluZWExLnRpbWVQcmljZUFycmF5Lmxlbmd0aDtcbiAgICAgICAgbGV0IGQxOiBJVGltZVByaWNlO1xuICAgICAgICBpZiAoaSA+PSB0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGQxID0gdGhpcy5saW5lYTEudGltZVByaWNlQXJyYXlbYUxlbmd0aCAtIDFdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZDEgPSB0aGlzLmxpbmVhMS50aW1lUHJpY2VBcnJheVtpXTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb25zb2xlLmxvZygnZDE6ICcsIGQxKTtcblxuICAgICAgICB0aGlzLmQgPVxuICAgICAgICAgICAgeDAuZ2V0VGltZSgpIC0gKGQwLnRpbWVzdGFtcCBhcyBEYXRlKS5nZXRUaW1lKCkgPlxuICAgICAgICAgICAgKGQxLnRpbWVzdGFtcCBhcyBEYXRlKS5nZXRUaW1lKCkgLSB4MC5nZXRUaW1lKClcbiAgICAgICAgICAgID8gZDFcbiAgICAgICAgICAgIDogZDA7XG4gICAgICAgIHRoaXMubW92ZVRvb2xUaXAoKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBtb3ZlVG9vbFRpcCgpIHtcbiAgICAgICAgbGV0IGRpc3RhbmNpYXg6IG51bWJlcjtcbiAgICAgICAgaWYgKHRoaXMubmV3eFNjYWxlKSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzXG4gICAgICAgICAgICAuYXR0cihcbiAgICAgICAgICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgICAgICBgdHJhbnNsYXRlKCR7dGhpcy5uZXd4U2NhbGUoXG4gICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKHRoaXMuZC50aW1lc3RhbXApLFxuICAgICAgICAgICAgICAgICl9LCR7dGhpcy5uZXd5U2NhbGUodGhpcy5kLnByaWNlKX0pYCk7XG5cbiAgICAgICAgICAgIGRpc3RhbmNpYXggPSB0aGlzLm5ld3hTY2FsZShuZXcgRGF0ZSh0aGlzLmQudGltZXN0YW1wKSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGlzdGFuY2lheDogJywgZGlzdGFuY2lheCk7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNcbiAgICAgICAgICAgIC5hdHRyKFxuICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nLFxuICAgICAgICAgICAgICAgIGB0cmFuc2xhdGUoJHt0aGlzLmNoYXJ0UHJvcHMueFNjYWxlKFxuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSh0aGlzLmQudGltZXN0YW1wKSxcbiAgICAgICAgICAgICAgICApfSwke3RoaXMuY2hhcnRQcm9wcy55U2NhbGUodGhpcy5kLnByaWNlKX0pYCk7XG5cbiAgICAgICAgICAgIGRpc3RhbmNpYXggPSB0aGlzLmNoYXJ0UHJvcHMueFNjYWxlKG5ldyBEYXRlKHRoaXMuZC50aW1lc3RhbXApKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdkaXN0YW5jaWF4OiAnLCBkaXN0YW5jaWF4KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLyogaWYgKHRoaXMuZDNldmVudHRyYW5zZm9ybSkge1xuICAgICAgICAgIHRoaXMuZm9jdXMuYXR0cihcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nLFxuICAgICAgICAgICAgdGhpcy5kM2V2ZW50dHJhbnNmb3JtXG4gICAgICAgICAgKVxuICAgICAgICB9ICovXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY2hhcnRQcm9wcy54U2NhbGUobmV3IERhdGUoZC5kYXRlKSkpO1xuXG4gICAgICAgIHRoaXMudGV4dFRvb2xUaXBcbiAgICAgICAgLnRleHQodGhpcy5nZXREYXRhUG9pbnQuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgY29uc3QgdHh0Tm9kZSA9IHRoaXMudGV4dFRvb2xUaXAubm9kZSgpIGFzIFNWR1RleHRFbGVtZW50O1xuXG4gICAgICAgIGxldCBiYm94O1xuXG4gICAgICAgIGJib3ggPSB0eHROb2RlLmdldEJCb3goKTtcblxuICAgICAgICBpZiAoYmJveC53aWR0aCArIDEwID4gZGlzdGFuY2lheCkge1xuICAgICAgICAgICAgdGhpcy50ZXh0VG9vbFRpcFxuICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ3N0YXJ0Jyk7XG4gICAgICAgICAgICBiYm94ID0gdHh0Tm9kZS5nZXRCQm94KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRleHRUb29sVGlwXG4gICAgICAgICAgICAuYXR0cigndGV4dC1hbmNob3InLCAnZW5kJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmZvY3VzLnNlbGVjdEFsbCgncmVjdCcpLnJlbW92ZSgpO1xuXG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmZvY3VzXG4gICAgICAgICAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAgICAgICAgIC5hdHRyKCd4JywgYmJveC54KVxuICAgICAgICAgICAgLmF0dHIoJ3knLCBiYm94LnkpXG4gICAgICAgICAgICAuYXR0cignd2lkdGgnLCBiYm94LndpZHRoKVxuICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGJib3guaGVpZ2h0KVxuICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgJ3doaXRlJylcbiAgICAgICAgICAgIC5zdHlsZSgnZmlsbC1vcGFjaXR5JywgJy45JylcbiAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyM2NjYnKVxuICAgICAgICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAnMC41cHgnKTtcblxuICAgICAgICB0aGlzLmZvY3VzLm5vZGUoKS5pbnNlcnRCZWZvcmUodHh0Tm9kZSwgbnVsbCk7XG5cbiAgICAgICAgbGV0IG5ld3kyID0gMDtcblxuICAgICAgICBpZiAodGhpcy5uZXd5U2NhbGUpIHtcbiAgICAgICAgICAgIG5ld3kyID0gdGhpcy5uZXd5U2NhbGUodGhpcy5kLnByaWNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld3kyID0gdGhpcy5jaGFydFByb3BzLnlTY2FsZSh0aGlzLmQucHJpY2UpO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBlc2NhbG8gbGEgcG9zaWNpb24geTIgZGUgbGEgbMOtbmVhIHNlZ8O6biBsYSBudWV2YSBlc2NhbGEgc2kgc2UgaGEgaGVjaG8gem9vbVxuICAgICAgICB0aGlzLmZvY3VzXG4gICAgICAgICAgICAuc2VsZWN0KCcueC1ob3Zlci1saW5lJylcbiAgICAgICAgICAgIC5hdHRyKCd5MicsIHRoaXMuaGVpZ2h0IC0gbmV3eTIpO1xuXG4gICAgICAgIC8vIG5vIGZ1bmNpb25hIGxhIGxpbmVhIGhvcml6b250YWxcbiAgICAgICAgdGhpcy5mb2N1cy5zZWxlY3QoJy55LWhvdmVyLWxpbmUnKS5hdHRyKCd4MicsIC0gZGlzdGFuY2lheCk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==